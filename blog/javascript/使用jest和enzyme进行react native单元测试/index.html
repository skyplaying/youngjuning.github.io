<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta name="title" content="æ´›ç«¹çš„å®˜æ–¹ç½‘ç«™" />
    <meta name="keywords" content="react, javascript, typescript" />
    <meta name="description" content="æ€•ä»€ä¹ˆçœŸç†æ— ç©·ï¼Œè¿›ä¸€å¯¸æœ‰ä¸€å¯¸çš„æ¬¢å–œ" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png"
    />
    <link rel="stylesheet" href="/umi.489b2084.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.9
    </script>
    <title>ä½¿ç”¨Jestå’ŒEnzymeè¿›è¡ŒReact Nativeå•å…ƒæµ‹è¯•</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/">æ´›ç«¹çš„å®˜æ–¹ç½‘ç«™</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/blog">åšå®¢</a></span><span><a href="/awesome">æ”¶è—</a></span><span><a href="/about">å…³äº</a></span><span><a href="/leetcode">ç®—æ³•</a></span><span><a href="/links">å‹é“¾</a></span><span>æ´›ç«¹æ–‡æ¡£â¤µï¸<ul><li><a href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">æ˜é‡‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">çŸ¥ä¹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">å‰ç«¯æ—©èŒ¶é¦†<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/"></a><h1>æ´›ç«¹çš„å®˜æ–¹ç½‘ç«™</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/blog">åšå®¢</a></li><li><a href="/awesome">æ”¶è—</a></li><li><a href="/about">å…³äº</a></li><li><a href="/leetcode">ç®—æ³•</a></li><li><a href="/links">å‹é“¾</a></li><li>æ´›ç«¹æ–‡æ¡£â¤µï¸<ul><li><a href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">æ˜é‡‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">çŸ¥ä¹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">å‰ç«¯æ—©èŒ¶é¦†<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/blog">Less is more</a></li><li><a href="/blog/deno">Deno</a><ul><li><a href="/blog/deno/deno git-hub action æºç è§£æ"><span>Deno GitHub Action æºç è§£æ</span></a></li><li><a href="/blog/deno/å‘ deno å­¦ä¹ è„šæœ¬çš„ç®¡ç†"><span>å‘ Deno å­¦ä¹ è„šæœ¬çš„ç®¡ç†</span></a></li></ul></li><li><a href="/blog/devops">Devops</a><ul><li><a href="/blog/devops/ç©è½¬ github actions"><span>ç©è½¬ GitHub Actions</span></a></li></ul></li><li><a href="/blog/go">Go</a><ul><li><a href="/blog/go/goè¯­æ³•å­¦ä¹ ç¬”è®°"><span>Go è¯­æ³•å­¦ä¹ ç¬”è®°</span></a></li><li><a href="/blog/go/åŸºäº go å®ç° deno upgrade"><span>åŸºäº Go å®ç° Deno upgrade</span></a></li><li><a href="/blog/go/æé€Ÿå…¥é—¨ go å¹¶çˆ¬å–æ˜é‡‘ä¸“æ "><span>æé€Ÿå…¥é—¨ Go å¹¶çˆ¬å–æ˜é‡‘ä¸“æ </span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog/javascript">Javascript</a><ul><li><a aria-current="page" class="active" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•"><span>ä½¿ç”¨Jestå’ŒEnzymeè¿›è¡ŒReact Nativeå•å…ƒæµ‹è¯•</span></a></li><li><a href="/blog/javascript/å›¾è§£google-v8-å­¦ä¹ ç¬”è®°"><span>å›¾è§£ Google V8 å­¦ä¹ ç¬”è®°</span></a></li></ul></li><li><a href="/blog/others">Others</a><ul><li><a href="/blog/others/ç¨‹åºå‘˜è´­é’»æŒ‡å—"><span>ç¨‹åºå‘˜è´­é’»æŒ‡å—ï¼šé’»æˆ’å€¼ä¸å€¼å¾—ä¹°ï¼Ÿæ€ä¹ˆä¹°ï¼Ÿ</span></a></li></ul></li><li><a href="/blog/react-native">react-native</a><ul><li><a href="/blog/react-native/react native è°ƒè¯•æœ€ä½³å®è·µ"><span>React Native è°ƒè¯•æœ€ä½³å®è·µ</span></a></li><li><a href="/blog/react-native/ç»™ react native åº“æ·»åŠ  example"><span>ç»™ React Native åº“æ·»åŠ  Example</span></a></li></ul></li><li><a href="/blog/rust">Rust</a><ul><li><a href="/blog/rust/ä¸€ä¸ªç•ªèŒ„é’Ÿå…¥é—¨ rust"><span>ä¸€ä¸ªç•ªèŒ„é’Ÿå…¥é—¨ Rust</span></a></li><li><a href="/blog/rust/rust è¯­æ³•å­¦ä¹ "><span>Rust è¯­æ³•å­¦ä¹ </span></a></li><li><a href="/blog/rust/rust ç¼–å†™çŒœæ•°æ¸¸æˆ"><span>Rust ç¼–å†™çŒœæ•°æ¸¸æˆ</span></a></li><li><a href="/blog/rust/ä¸ºä»€ä¹ˆrustéœ€è¦å±€éƒ¨å˜é‡éšè—"><span>ä¸ºä»€ä¹ˆ Rust éœ€è¦å±€éƒ¨å˜é‡éšè—</span></a></li></ul></li><li><a href="/blog/tools">Tools</a><ul><li><a href="/blog/tools/å‘å¸ƒä¸€ä¸ª homebrew åŒ…"><span>å‘å¸ƒä¸€ä¸ª Homebrew åŒ…</span></a></li><li><a href="/blog/tools/æˆ‘çš„macå¼€å‘ç¯å¢ƒ"><span>æˆ‘çš„ Mac å¼€å‘ç¯å¢ƒ</span></a></li></ul></li><li><a href="/blog/typescript">Typescript</a><ul><li><a href="/blog/typescript/å‘å¾®è½¯å®˜æ–¹è´¡çŒ® @types åŒ…"><span>å‘å¾®è½¯å®˜æ–¹è´¡çŒ® @types åŒ…</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ ğŸ§" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ-ğŸ§"><span>å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ ğŸ§</span></a></li><li title="å…¶ä»–æµ‹è¯•" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å…¶ä»–æµ‹è¯•"><span>å…¶ä»–æµ‹è¯•</span></a></li><li title="æµ‹è¯•è¦†ç›–ç‡" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#æµ‹è¯•è¦†ç›–ç‡"><span>æµ‹è¯•è¦†ç›–ç‡</span></a></li><li title="å®‰è£…ä¾èµ–" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å®‰è£…ä¾èµ–"><span>å®‰è£…ä¾èµ–</span></a></li><li title="é…ç½®" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#é…ç½®"><span>é…ç½®</span></a></li><li title="jest.config.js" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#jestconfigjs"><span>jest.config.js</span></a></li><li title="jest.setup.js" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#jestsetupjs"><span>jest.setup.js</span></a></li><li title="enzyme å…¥é—¨" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#enzyme-å…¥é—¨"><span>enzyme å…¥é—¨</span></a></li><li title="shallow" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#shallow"><span>shallow</span></a></li><li title="mount" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#mount"><span>mount</span></a></li><li title="render" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#render"><span>render</span></a></li><li title="ç»„ä»¶æµ‹è¯•" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç»„ä»¶æµ‹è¯•"><span>ç»„ä»¶æµ‹è¯•</span></a></li><li title="ç»„ä»¶å¿«ç…§æµ‹è¯•" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç»„ä»¶å¿«ç…§æµ‹è¯•"><span>ç»„ä»¶å¿«ç…§æµ‹è¯•</span></a></li><li title="ç”Ÿå‘½å‘¨æœŸæµ‹è¯•" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç”Ÿå‘½å‘¨æœŸæµ‹è¯•"><span>ç”Ÿå‘½å‘¨æœŸæµ‹è¯•</span></a></li><li title="å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆTimer Mocksï¼‰" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆtimer-mocksï¼‰"><span>å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆTimer Mocksï¼‰</span></a></li><li title="FAQ" data-depth="2"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#faq"><span>FAQ</span></a></li><li title="å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç " data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç "><span>å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç </span></a></li><li title="ä½¿ç”¨ mount æ—¶ï¼Œå¿½ç•¥ React Native çš„è­¦å‘Š" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ä½¿ç”¨-mount-æ—¶ï¼Œå¿½ç•¥-react-native-çš„è­¦å‘Š"><span>ä½¿ç”¨ mount æ—¶ï¼Œå¿½ç•¥ React Native çš„è­¦å‘Š</span></a></li><li title="å…¶ä»– issues" data-depth="3"><a href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å…¶ä»–-issues"><span>å…¶ä»– issues</span></a></li></ul><div class="__dumi-default-layout-content"><div style="display:flex;justify-content:center"><img width="70%"/></div><div class="markdown"><h2 id="å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ-ğŸ§"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ-ğŸ§"><span class="icon,icon-link"></span></a>å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ ğŸ§</h2><p>å…¶ä¸­å•å…ƒæµ‹è¯•æ˜¯ç”¨æ¥å¯¹ä¸€ä¸ªæ¨¡å—ã€ä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ä¸ªç±»æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚ç¨‹åºå•å…ƒæ˜¯åº”ç”¨çš„æœ€å°å¯æµ‹è¯•éƒ¨ä»¶ï¼Œåœ¨ React ç¼–ç¨‹ä¸­ï¼Œæœ€å°å•å…ƒé€šå¸¸æ˜¯ç»„ä»¶ã€å‡½æ•°ã€‚å¦‚æœä½ ç†Ÿæ‚‰â€œæµ‹è¯•é©±åŠ¨å¼€å‘â€ï¼ˆTDDï¼šTest-Driven Developmentï¼‰ï¼Œå•å…ƒæµ‹è¯•ä¹Ÿä¸ä¼šé™Œç”Ÿï¼Œç‹­ä¹‰æ¥è¯´å°±æ˜¯å•æµ‹é©±åŠ¨å¼€å‘ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œç¨‹åºå‘˜æ¯ä¿®æ”¹ä¸€æ¬¡ç¨‹åºå°±ä¼šè¿›è¡Œæœ€å°‘ä¸€æ¬¡å•å…ƒæµ‹è¯•ï¼Œåœ¨ç¼–å†™ç¨‹åºçš„è¿‡ç¨‹ä¸­å‰åå¾ˆå¯èƒ½è¦è¿›è¡Œå¤šæ¬¡å•å…ƒæµ‹è¯•ï¼Œä»¥è¯å®ç¨‹åºè¾¾åˆ°è½¯ä»¶è§„æ ¼ä¹¦è¦æ±‚çš„å·¥ä½œç›®æ ‡ï¼Œæ²¡æœ‰ç¨‹åºé”™è¯¯ã€‚åœ¨ TDD ä¸­ï¼Œç”šè‡³æ˜¯å…ˆæ ¹æ®è®¾è®¡ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç„¶åæ ¹æ®å•å…ƒæµ‹è¯•å†™ä»£ç ã€‚</p><p>ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·ï¼Œå•å…ƒæµ‹è¯•å’Œæ–‡æ¡£ä¸€æ ·ï¼Œæ˜¯ä¿éšœç¨‹åºæœ€å°å•å…ƒè´¨é‡çš„é‡è¦ä¸€ç¯ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œä¸€å—ç –å¯èƒ½ä¸éœ€è¦ä½¿ç”¨è¯´æ˜ä¹¦å°±å¯ä»¥é‡äº§ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€å—ç –ä¸ç»è´¨æ£€æµ‹éªŒå°±æŠ•å…¥ä½¿ç”¨å¸¦æ¥çš„åæœå¯èƒ½æ˜¯ææ€–çš„ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œå•æµ‹å¯èƒ½æ˜¯æ¯”æ–‡æ¡£æ›´é‡è¦çš„å­˜åœ¨ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿä¸æå€¡ä¸ºäº†å•æµ‹è€Œå•æµ‹ï¼Œå•æµ‹æ˜¯ä¸ºäº†é˜²èŒƒäºæœªç„¶ã€‚</p><h2 id="å…¶ä»–æµ‹è¯•"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å…¶ä»–æµ‹è¯•"><span class="icon,icon-link"></span></a>å…¶ä»–æµ‹è¯•</h2><p>å‰ç«¯æµ‹è¯•å¸¸è§çš„æµ‹è¯•ç±»å‹æœ‰å•å…ƒæµ‹è¯•(Unit testing)ã€é›†æˆæµ‹è¯•(Integration testing)ã€ç«¯åˆ°ç«¯(E2E testing)æµ‹è¯•ï¼Œä¸€èˆ¬æˆ‘ä»¬æŠ•å…¥çš„æµ‹è¯•èµ„æºæ’åºå¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/01/11/fCwizOy7otrgP31.png" alt=""/></p><p>é›†æˆæµ‹è¯•æ˜¯åœ¨å•å…ƒæµ‹è¯•çš„åŸºç¡€ä¸Šï¼Œé›†æˆå¤šä¸ªæ¨¡å—è¿›è¡Œæµ‹è¯•ï¼Œç¡®ä¿æ¨¡å—ä¹‹é—´äº’åŠ¨è¡Œä¸ºæ­£ç¡®æ— è¯¯çš„å·¥ä½œã€‚æœ‰æ—¶ï¼Œå•ä¸€çš„æ¨¡å—å®Œå…¨é€šè¿‡å•å…ƒæµ‹è¯•ï¼Œå•ç‹¬ä½¿ç”¨ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“ä¸å…¶ä»–æ¨¡å—é…åˆä½¿ç”¨æ—¶ï¼Œå¯èƒ½å°±å‡ºç°é—®é¢˜äº†ï¼Œä¸‹å›¾æ˜¯æœªé€šè¿‡é›†æˆæµ‹è¯•çš„ä¾‹å­ï¼š</p><p><img src="https://user-images.githubusercontent.com/88981/52933895-c0d47600-338f-11e9-9034-11e1ad0c42f1.gif" alt=""/></p><p>ç«¯åˆ°ç«¯æµ‹è¯•æ˜¯ç«™åœ¨ç”¨æˆ·è§’åº¦å‡ºå‘ï¼ˆä¸€ç«¯ï¼‰åˆ°çœŸå®è¿è¡Œç¯å¢ƒï¼ˆå¦ä¸€ç«¯ï¼‰è¿›è¡Œæµ‹è¯•ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šä½¿ç”¨ Cypressã€puppeteer è¿™äº›å·¥å…·è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ä»¥æ›¿ä»£äººè‚‰æµ‹è¯•ã€‚ä¸‹å›¾æ˜¯æœªé€šè¿‡ç«¯åˆ°ç«¯æµ‹è¯•çš„ä¾‹å­ï¼š</p><p><img src="https://imgur.com/download/Po1unSh" alt=""/></p><h2 id="æµ‹è¯•è¦†ç›–ç‡"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#æµ‹è¯•è¦†ç›–ç‡"><span class="icon,icon-link"></span></a>æµ‹è¯•è¦†ç›–ç‡</h2><p>æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œä¼šç»å¸¸å…³å¿ƒæˆ‘ä»¬çš„ä»£ç æ˜¯å¦éƒ½æµ‹è¯•åˆ°äº†ï¼Œä»¥åŠå“ªäº›ä»£ç æ²¡æœ‰æµ‹è¯•åˆ°ã€‚jest å†…ç½®äº† Istanbul æµ‹è¯•è¦†ç›–ç‡å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å››ä¸ªç»´åº¦çš„è¦†ç›–ç‡æ¥äº†è§£ä»£ç æµ‹è¯•è¦†ç›–ç‡æƒ…å†µï¼š</p><ul><li>Statementsï¼ˆstmtsï¼‰ï¼šè¡¨è¾¾å¼è¦†ç›–ç‡ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ªè¡¨è¾¾å¼éƒ½æ‰§è¡Œäº†ï¼Ÿ</li><li>Branchesï¼ˆBranchï¼‰ï¼šåˆ†æ”¯è¦†ç›–ç‡ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ª if ä»£ç å—éƒ½æ‰§è¡Œäº†ï¼Ÿ</li><li>Functionsï¼ˆFuncsï¼‰ï¼šå‡½æ•°è¦†ç›–ç‡ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸ªå‡½æ•°éƒ½è°ƒç”¨äº†ï¼Ÿ</li><li>Linesï¼ˆLinesï¼‰ï¼šè¡Œè¦†ç›–ç‡ï¼Œæ˜¯ä¸æ˜¯æ¯ä¸€è¡Œéƒ½æ‰§è¡Œäº†ï¼Ÿ</li></ul><p>ä¸‹å›¾æ˜¯æ‰§è¡Œ <code>jest --coverage</code> ä¹‹åç”Ÿæˆçš„å‘½ä»¤è¡Œè¾“å‡ºï¼š</p><p><img src="https://i.loli.net/2021/01/11/YotSCDuzZld19NK.png" alt=""/></p><p>ä¸‹å›¾æ˜¯ç”Ÿæˆçš„ç²¾ç¾çš„æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼š</p><p><img src="https://i.loli.net/2021/01/11/qvCH4Z6EFQNapdS.png" alt=""/></p><p>ç‚¹å‡» App.js å¯ä»¥æŸ¥çœ‹å•ä¸ªæ–‡ä»¶çš„æµ‹è¯•è¦†ç›–ç‡æƒ…å†µï¼š</p><p><img src="https://i.loli.net/2021/01/11/lsvKWHejBy6mGAF.png" alt=""/></p><p>ç‚¹å¼€æ¯ä¸ªä¹Ÿæ²¡ä½ ï¼Œä½ ä¼šçœ‹åˆ°é¡µé¢æ˜¯äº”é¢œå…­è‰²çš„ï¼Œåˆ«æ‹…å¿ƒï¼Œè¿™äº›é¢œè‰²éƒ½æ˜¯æœ‰æ˜ç¡®çš„æ„ä¹‰ï¼š</p><ul><li>ç²‰ç´…è‰²çš„ä»£ç : å°šæœªè¢«æ‰§è¡Œçš„ statement æˆ– function</li><li>é»„è‰²çš„ä»£ç : æ²’è¢«è¦†ç›–åˆ°çš„ branch</li><li>I: ä»£è¡¨ if-else çš„ if æ²¡æœ‰è¢«æ‰§è¡Œ<blockquote><p><img src="https://i.loli.net/2021/01/11/NE9JdFyrb4oZKnA.png" alt=""/></p></blockquote></li><li>E: ä»£è¡¨ if-else çš„ if æ²¡æœ‰è¢«æ‰§è¡Œ<blockquote><p><img src="https://i.loli.net/2021/01/11/Dyl37O6UC2WoBnp.png" alt=""/></p></blockquote></li><li>Nx: ä»£è¡¨ä»£ç å—è¢«æ‰§è¡Œåˆ°çš„æ¬¡æ•°ï¼Œå¯ä»¥ä½œä¸ºä»£ç æ€§èƒ½çš„å‚è€ƒä¾æ®</li></ul><h2 id="å®‰è£…ä¾èµ–"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å®‰è£…ä¾èµ–"><span class="icon,icon-link"></span></a>å®‰è£…ä¾èµ–</h2><div class="__dumi-default-code-block"><pre class="prism-code language-shell"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> jest -D</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># babel</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> babel-jest -D</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># enzyme</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> enzyme jest-enzyme enzyme-adapter-react-16 enzyme-to-json -D</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># react-native-mock-render</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> react-native-mock-render -D</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># types</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">yarn</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> @types/enzyme @types/jest @types/react @types/react-native -D</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>å·¥å…·ä»‹ç»ï¼š</p><ul><li>jest: Jest æ˜¯ä¸€ä¸ªä»¤äººæ„‰å¿«çš„ JavaScript æµ‹è¯•æ¡†æ¶ï¼Œä¸“æ³¨äºç®€æ´æ˜å¿«ã€‚</li><li>enzyme: Enzyme æ˜¯ç”¨äº React çš„ JavaScript æµ‹è¯•å®ç”¨ç¨‹åºï¼Œå¯ä»¥æ›´è½»æ¾åœ°æµ‹è¯• React ç»„ä»¶çš„è¾“å‡ºã€‚æ‚¨è¿˜å¯ä»¥æ ¹æ®ç»™å®šçš„è¾“å‡ºè¿›è¡Œæ“ä½œï¼Œéå†å¹¶ä»¥æŸç§æ–¹å¼æ¨¡æ‹Ÿè¿è¡Œæ—¶ã€‚</li><li>jest-enzyme: é’ˆå¯¹ enzyme çš„ Jest æ–­è¨€</li><li>enzyme-adapter-react-16: React Native æµ‹è¯•æ‰€éœ€çš„æ¡¥æ¥å™¨</li><li>enzyme-to-json: å°† Enzyme wrappers è½¬æ¢æˆç¬¦åˆ Jest å¿«ç…§æµ‹è¯•çš„ JSON æ ¼å¼ã€‚</li><li>react-native-mock-render: A fully mocked and test-friendly version of react native</li></ul><h2 id="é…ç½®"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#é…ç½®"><span class="icon,icon-link"></span></a>é…ç½®</h2><h3 id="jestconfigjs"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#jestconfigjs"><span class="icon,icon-link"></span></a>jest.config.js</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  preset</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;react-native&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  verbose</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  collectCoverage</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  moduleNameMapper</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// for https://github.com/facebook/jest/issues/919</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;^image![a-zA-Z0-9$_-]+$&#x27;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;GlobalImageStub&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;^[@./a-zA-Z0-9$_-]+\\.(png|gif)$&#x27;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;RelativeImageStub&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  setupFilesAfterEnv</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;&lt;rootDir&gt;/jest.setup.js&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  snapshotSerializers</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;enzyme-to-json/serializer&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><ul><li>collectCoverage: ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</li><li>setupFilesAfterEnv: ä½¿ç”¨ Jest è¿è¡Œå®‰è£…æ–‡ä»¶ä»¥é…ç½® Enzyme å’Œé€‚é…å™¨ï¼ˆå¦‚ä¸‹æ–‡<code>jest.setup.js</code>ä¸­æ‰€ç¤ºï¼‰ï¼Œä¹‹å‰æ˜¯<code>setupTestFrameworkScriptFile</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>setupFiles</code></li><li>snapshotSerializersï¼šæ¨èä½¿ç”¨åºåˆ—åŒ–ç¨‹åºä½¿ç”¨<code>enzyme-to-json</code>ï¼Œå®ƒçš„å®‰è£…å’Œä½¿ç”¨éå¸¸ç®€å•ï¼Œå¹¶å…è®¸æ‚¨ç¼–å†™ç®€æ´çš„å¿«ç…§æµ‹è¯•ã€‚</li></ul><blockquote><p>æ³¨æ„ï¼šJest åœ¨ <a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/55752673/option-setuptestframeworkscriptfile-was-replaced-by-configuration-setupfilesa">24.1.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä¹‹ååªèƒ½ä½¿ç”¨ <code>setupFilesAfterEnv</code></p></blockquote><h3 id="jestsetupjs"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#jestsetupjs"><span class="icon,icon-link"></span></a>jest.setup.js</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token string">&#x27;react-native&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token string">&#x27;react-native-mock-render/mock&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token string">&#x27;react-native/Libraries/Animated/src/bezier&#x27;</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// for https://github.com/facebook/jest/issues/4710</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Enzyme</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Adapter</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme-adapter-react-16&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token maybe-class-name">Enzyme</span><span class="token punctuation">.</span><span class="token method function property-access">configure</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> adapter</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">Adapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h2 id="enzyme-å…¥é—¨"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#enzyme-å…¥é—¨"><span class="icon,icon-link"></span></a>enzyme å…¥é—¨</h2><p>enzyme æ˜¯ Airbnb å¼€æºçš„ react æµ‹è¯•ç±»åº“ï¼Œæä¾›äº†ä¸€å¥—ç®€æ´å¼ºå¤§çš„ APIï¼Œå¹¶é€šè¿‡ jquery é£æ ¼çš„æ–¹å¼è¿›è¡Œ dom å¤„ç†ï¼Œå¼€å‘ä½“éªŒååˆ†å‹å¥½. å®ƒæä¾›ä¸‰ç§æµ‹è¯•æ–¹æ³•.</p><h3 id="shallow"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#shallow"><span class="icon,icon-link"></span></a>shallow</h3><p>shallow è¿”å›ç»„ä»¶çš„æµ…æ¸²æŸ“ï¼Œå¯¹å®˜æ–¹ shallow rendering è¿›è¡Œå°è£…ã€‚æµ…æ¸²æŸ“ ä½œç”¨å°±æ˜¯ï¼šå®ƒä»…ä»…ä¼šæ¸²æŸ“è‡³è™šæ‹Ÿ domï¼Œä¸ä¼šè¿”å›çœŸå®çš„ dom èŠ‚ç‚¹ï¼Œè¿™ä¸ªå¯¹æµ‹è¯•æ€§èƒ½æœ‰æå¤§çš„æå‡ã€‚shallow åªæ¸²æŸ“å½“å‰ç»„ä»¶ï¼Œåªèƒ½èƒ½å¯¹å½“å‰ç»„ä»¶åšæ–­è¨€</p><h3 id="mount"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#mount"><span class="icon,icon-link"></span></a>mount</h3><p>mount æ–¹æ³•ç”¨äºå°† React ç»„ä»¶åŠ è½½ä¸ºçœŸå® DOM èŠ‚ç‚¹ã€‚mount ä¼šæ¸²æŸ“å½“å‰ç»„ä»¶ä»¥åŠæ‰€æœ‰å­ç»„ä»¶ã€‚å¤šæ•°æƒ…å†µä¸‹ï¼Œshallow æ–¹æ³•å°±èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚äº†ã€‚ref æµ‹è¯•åˆ™æ—¨åœ¨ mount æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚</p><h3 id="render"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#render"><span class="icon,icon-link"></span></a>render</h3><p>render é‡‡ç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹åº“ Cheerio çš„æ¸²æŸ“ï¼Œæ¸²æŸ“ç»“æœæ˜¯æ™®é€šçš„ html ç»“æ„ï¼Œå¯¹äº snapshot ä½¿ç”¨ render æ¯”è¾ƒåˆé€‚ã€‚</p><h2 id="ç»„ä»¶æµ‹è¯•"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç»„ä»¶æµ‹è¯•"><span class="icon,icon-link"></span></a>ç»„ä»¶æµ‹è¯•</h2><h3 id="ç»„ä»¶å¿«ç…§æµ‹è¯•"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç»„ä»¶å¿«ç…§æµ‹è¯•"><span class="icon,icon-link"></span></a>ç»„ä»¶å¿«ç…§æµ‹è¯•</h3><p>å½“æˆ‘ä»¬è¦ç¡®ä¿ UI ä¸ä¼šæ„å¤–æ›´æ”¹æ—¶ï¼Œå¿«ç…§æµ‹è¯•éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚é€šè¿‡ <code>toMatchSnapshot</code> å³å¯å®Œæˆã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;Button Component&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;basic render&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> component </span><span class="token operator">=</span><span class="token plain"> renderer</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Button</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">component</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="ç”Ÿå‘½å‘¨æœŸæµ‹è¯•"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ç”Ÿå‘½å‘¨æœŸæµ‹è¯•"><span class="icon,icon-link"></span></a>ç”Ÿå‘½å‘¨æœŸæµ‹è¯•</h3><h4 id="componentdidmount"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#componentdidmount"><span class="icon,icon-link"></span></a>componentDidMount</h4><p>é€šè¿‡è°ƒç”¨ <code>shallow</code> å’Œ <code>mount</code> æ–¹æ³•ï¼Œå¯ä»¥è§¦å‘ componentDidMount ç”Ÿå‘½å‘¨æœŸï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> shallow </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter punctuation">{</span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">CarouselComponent</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> instance </span><span class="token operator">=</span><span class="token plain"> wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;Carousel Component&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;renders correctly&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>ä¹Ÿå¯ä»¥é€šè¿‡ <code>wrapper.setState</code> æ–¹æ³•è¿›è¡Œè§¦å‘ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> shallow </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter punctuation">{</span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> instance </span><span class="token operator">=</span><span class="token plain"> wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;Component&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;renders correctly&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      enable</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h4 id="componentwillunmont"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#componentwillunmont"><span class="icon,icon-link"></span></a>componentWillUnMont</h4><p>é€šè¿‡è°ƒç”¨ <code>wrapper.unmount()</code> å¯ä»¥è§¦å‘ componentWillUnMont ç”Ÿå‘½å‘¨æœŸï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> shallow </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter punctuation">{</span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> instance </span><span class="token operator">=</span><span class="token plain"> wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;Carousel Component&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;renders correctly&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token plain">wrapper</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h4 id="componentwillreceiveprops"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#componentwillreceiveprops"><span class="icon,icon-link"></span></a>componentWillReceiveProps</h4><p>å¯ä»¥é€šè¿‡ <code>wrapper.setProps</code> æ–¹æ³•è§¦å‘ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> shallow </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props </span><span class="token parameter operator">=</span><span class="token parameter"> </span><span class="token parameter punctuation">{</span><span class="token parameter punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> wrapper </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">shallow</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> instance </span><span class="token operator">=</span><span class="token plain"> wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;componentWillReceiveProps&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    autoplay</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">setProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> autoplay</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆtimer-mocksï¼‰"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆtimer-mocksï¼‰"><span class="icon,icon-link"></span></a>å®šæ—¶å™¨æ¨¡æ‹Ÿï¼ˆTimer Mocksï¼‰</h3><p>åŸç”Ÿå®šæ—¶å™¨åŠŸèƒ½(å³ setTimeoutï¼ŒsetIntervalï¼ŒclearTimeoutï¼ŒclearInterval)å¯¹äºæµ‹è¯•ç¯å¢ƒæ¥è¯´ä¸å¤ªç†æƒ³ï¼Œå› ä¸ºå®ƒä»¬ä¾èµ–äºå®æ—¶æ—¶é—´ã€‚ Jest å¯ä»¥å°†å®šæ—¶å™¨æ¢æˆå…è®¸æˆ‘ä»¬è‡ªå·±æ§åˆ¶æ—¶é—´çš„åŠŸèƒ½ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>jest.useFakeTimers()</code> æ¥å¯ç”¨å‡å®šæ—¶å™¨ã€‚ç„¶ååœ¨éœ€è¦çš„æ—¶å€™æ‰§è¡Œ <code>jest.runOnlyPendingTimers()</code> æ¥è§¦å‘å®šæ—¶å™¨ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token imports punctuation">{</span><span class="token imports"> shallow </span><span class="token imports punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;enzyme&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">jest</span><span class="token punctuation">.</span><span class="token method function property-access">useFakeTimers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#x27;autoplay methods with count(2) and os(ios)&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> wrapper</span><span class="token punctuation">,</span><span class="token plain"> instance </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    autoplay</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    loop</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  wrapper</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> isScrolling</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    jest</span><span class="token punctuation">.</span><span class="token method function property-access">runOnlyPendingTimers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h2 id="faq"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#faq"><span class="icon,icon-link"></span></a>FAQ</h2><h3 id="å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç "><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç "><span class="icon,icon-link"></span></a>å¦‚ä½•å¿½ç•¥æŸä¸€å—ä»£ç </h3><p>æ·»åŠ ä»¥ä¸‹æ ¼å¼çš„æ³¨é‡Šåˆ°è¦å¿½ç•¥çš„ä»£ç å—å‰å³å¯ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">/* istanbul ignore next */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="ä½¿ç”¨-mount-æ—¶ï¼Œå¿½ç•¥-react-native-çš„è­¦å‘Š"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#ä½¿ç”¨-mount-æ—¶ï¼Œå¿½ç•¥-react-native-çš„è­¦å‘Š"><span class="icon,icon-link"></span></a>ä½¿ç”¨ mount æ—¶ï¼Œå¿½ç•¥ React Native çš„è­¦å‘Š</h3><ul><li>å‚è€ƒè‡ªï¼š<a target="_blank" rel="noopener noreferrer" href="https://github.com/enzymejs/enzyme/issues/831#issuecomment-352934963">Remove warnings when rendering react-native components<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#x27;mounting&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> origConsole </span><span class="token operator">=</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token property-access">error</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">error</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token property-access">error</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> origConsole</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    it </span><span class="token spread operator">...</span><span class="token spread operator">...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">       mount</span><span class="token spread operator">...</span><span class="token punctuation">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="å…¶ä»–-issues"><a aria-hidden="true" tabindex="-1" href="/blog/javascript/ä½¿ç”¨jestå’Œenzymeè¿›è¡Œreact nativeå•å…ƒæµ‹è¯•#å…¶ä»–-issues"><span class="icon,icon-link"></span></a>å…¶ä»– issues</h3><ul><li><p>enzyme</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/enzymejs/enzyme/issues/1436">Create Adapter for React Native &amp; React 16<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/enzymejs/enzyme/issues/991">Can&#x27;t simulate press event in react-native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/enzymejs/enzyme/issues/1636">Shallow with New React Context API. Consumer not getting context<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/40776121/enzyme-is-not-finding-component-by-props">Enzyme is not finding component by props<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><p>jest</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/jest/issues/4710">TypeError: Cannot read property &#x27;Object.<anonymous>&#x27; of null</anonymous><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/46252396/jest-how-to-test-if-a-component-does-not-exist">Jest - how to test if a component does not exist?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/enzymejs/enzyme/issues/316">Refs not working in component being shallow rendered<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/jest/issues/6434">ReferenceError: You are trying to <code>import</code> a file after the Jest environment has been torn down.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><p>react-native</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/jest/issues/919">requiring image in react-native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/jest/issues/3822">Cannot find module &#x27;setupDevtools&#x27; from &#x27;setup.js&#x27;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/react-navigation/react-navigation/issues/7950#issuecomment-615220412">Unable to resolve module <code>./views/assets/back-icon.png</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io/edit/main/docs/blog/javascript/ä½¿ç”¨Jestå’ŒEnzymeè¿›è¡ŒReact Nativeå•å…ƒæµ‹è¯•.md">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="æœ€åæ›´æ–°æ—¶é—´ï¼š">2/24/2021 04:26:09</span></div></div><div class="ant-back-top"></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.0e9af526.js"></script>
  </body>
</html>
