<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta name="title" content="洛竹的官方网站" />
    <meta name="keywords" content="react, javascript, typescript" />
    <meta name="description" content="怕什么真理无穷，进一寸有一寸的欢喜" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png"
    />
    <link rel="stylesheet" href="/umi.26fedac2.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.9
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.includes(e) ? e : r[0]
        );
      })();
    </script>
    <title>向 Deno 学习脚本的管理</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/blog/deno/向 deno 学习脚本的管理" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/">洛竹的官方网站</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/blog">博客</a></span><span><a href="/awesome">收藏</a></span><span><a href="/about">关于</a></span><span><a href="/leetcode">算法</a></span><span><a href="/links">友链</a></span><span>洛竹文档⤵️<ul><li><a href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/"></a><h1>洛竹的官方网站</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/blog">博客</a></li><li><a href="/awesome">收藏</a></li><li><a href="/about">关于</a></li><li><a href="/leetcode">算法</a></li><li><a href="/links">友链</a></li><li>洛竹文档⤵️<ul><li><a href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/blog">Less is more</a></li><li><a aria-current="page" class="active" href="/blog/deno">Deno</a><ul><li><a href="/blog/deno/deno git-hub action 源码解析"><span>Deno GitHub Action 源码解析</span></a></li><li><a aria-current="page" class="active" href="/blog/deno/向 deno 学习脚本的管理"><span>向 Deno 学习脚本的管理</span></a></li></ul></li><li><a href="/blog/devops">Devops</a><ul><li><a href="/blog/devops/玩转 github actions"><span>玩转 GitHub Actions</span></a></li></ul></li><li><a href="/blog/go">Go</a><ul><li><a href="/blog/go/go语法学习笔记"><span>Go 语法学习笔记</span></a></li><li><a href="/blog/go/基于 go 实现 deno upgrade"><span>基于 Go 实现 Deno upgrade</span></a></li><li><a href="/blog/go/极速入门 go 并爬取掘金专栏"><span>极速入门 Go 并爬取掘金专栏</span></a></li></ul></li><li><a href="/blog/javascript">Javascript</a><ul><li><a href="/blog/javascript/使用jest和enzyme进行react native单元测试"><span>使用Jest和Enzyme进行React Native单元测试</span></a></li><li><a href="/blog/javascript/图解google-v8-学习笔记"><span>图解 Google V8 学习笔记</span></a></li></ul></li><li><a href="/blog/others">Others</a><ul><li><a href="/blog/others/程序员购钻指南"><span>程序员购钻指南：钻戒值不值得买？怎么买？</span></a></li></ul></li><li><a href="/blog/react-native">react-native</a><ul><li><a href="/blog/react-native/flutter-vs-react-native–what-to-choose-in-2021"><span>2021 Flutter 完胜 React Native ?</span></a></li><li><a href="/blog/react-native/react native 调试最佳实践"><span>React Native 调试最佳实践</span></a></li><li><a href="/blog/react-native/当我们在聊 rn 时，我们在谈什么"><span>当我们在聊 RN 时，我们在聊什么|技术点评</span></a></li><li><a href="/blog/react-native/给 react native 库添加 example"><span>给 React Native 库添加 Example</span></a></li></ul></li><li><a href="/blog/rust">Rust</a><ul><li><a href="/blog/rust/一个番茄钟入门 rust"><span>一个番茄钟入门 Rust</span></a></li><li><a href="/blog/rust/rust 语法学习"><span>Rust 语法学习</span></a></li><li><a href="/blog/rust/rust 编写猜数游戏"><span>Rust 编写猜数游戏</span></a></li><li><a href="/blog/rust/为什么rust需要局部变量隐藏"><span>为什么 Rust 需要局部变量隐藏</span></a></li><li><a href="/blog/rust/rust 在 web 领域的应用"><span>Rust 在 Web 领域的应用</span></a></li></ul></li><li><a href="/blog/tools">Tools</a><ul><li><a href="/blog/tools/发布一个 homebrew 包"><span>发布一个 Homebrew 包</span></a></li><li><a href="/blog/tools/我的mac开发环境"><span>我的 Mac 开发环境</span></a></li></ul></li><li><a href="/blog/typescript">Typescript</a><ul><li><a href="/blog/typescript/向微软官方贡献 @types 包"><span>向微软官方贡献 @types 包</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="前言 🌱" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#前言-"><span>前言 🌱</span></a></li><li title="Deno 安装方式分析" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#deno-安装方式分析"><span>Deno 安装方式分析</span></a></li><li title="准备一个项目" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#准备一个项目"><span>准备一个项目</span></a></li><li title="编译项目" data-depth="3"><a href="/blog/deno/向 deno 学习脚本的管理#编译项目"><span>编译项目</span></a></li><li title="Windows 安装脚本" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#windows-安装脚本"><span>Windows 安装脚本</span></a></li><li title="自定义安装脚本" data-depth="3"><a href="/blog/deno/向 deno 学习脚本的管理#自定义安装脚本"><span>自定义安装脚本</span></a></li><li title="类 Unix 安装脚本" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#类-unix-安装脚本"><span>类 Unix 安装脚本</span></a></li><li title="自定义脚本" data-depth="3"><a href="/blog/deno/向 deno 学习脚本的管理#自定义脚本"><span>自定义脚本</span></a></li><li title="国内加速" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#国内加速"><span>国内加速</span></a></li><li title="预告" data-depth="2"><a href="/blog/deno/向 deno 学习脚本的管理#预告"><span>预告</span></a></li></ul><div class="__dumi-default-layout-content"><span class="__dumi-default-badge">掘金专栏</span><div style="display:flex;justify-content:center"><img width="70%"/></div><div class="markdown"><h2 id="前言-"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#前言-"><span class="icon icon-link"></span></a>前言 🌱</h2><p>如果你使用过 Deno、Go 或者配置过 Android Studio，那么你一定对配置环境变量不陌生。那么如果我们自己写了一个脚本或者命令行工具，如何分享给朋友们玩呢？最简单的当然是直接把脚本放出去，供别人手动下载和手动配置环境变量。但这既不优雅，也不利于传播，本文就是研读了 Deno 的安装机制后，总结出的一套可用的二进制可执行文件分发教程。</p><blockquote><p>Deno 在 <a target="_blank" rel="noopener noreferrer" href="https://github.com/denoland/deno/releases/tag/v1.7.0">v1.7.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 支持了 <a target="_blank" rel="noopener noreferrer" href="https://github.com/denoland/deno/pull/9141">交叉编译<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，本文就以 Deno 实现一个简单的 CLI 工具 并分发给 MacOS、Linux、Windows 用户。</p></blockquote><h2 id="deno-安装方式分析"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#deno-安装方式分析"><span class="icon icon-link"></span></a>Deno 安装方式分析</h2><p>从官网中，我们可以看到 Deno 有多种安装方式，主要有：</p><ul><li>With Shell（Linux/MacOS）：<code>curl -fsSL https://deno.land/x/install/install.sh | sh</code></li><li>With PowerShell（Windows）：<code>iwr https://deno.land/x/install/install.ps1 -useb | iex</code></li><li>With Homebrew：<code>brew install deno</code></li></ul><p>并且还可以安装特定版本：</p><ul><li>With Shell: <code>curl -fsSL https://deno.land/x/install/install.sh | sh -s v1.0.0</code></li><li>With PowerShell: <code>$v=&quot;1.0.0&quot;; iwr https://deno.land/x/install/install.ps1 -useb | iex</code></li></ul><p>其中 Homebrew 方式需要将安装脚本合并到 <a target="_blank" rel="noopener noreferrer" href="https://github.com/Homebrew/homebrew-core">homebrew-core<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，但是我们的脚本一般比较小众，可以参考 <a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/6922347045692899336">不会吧？不会吧！还有人不会发 Homebrew 包？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 发布到自己的 <code>tap</code> 中。对于 Shell 和 PowerShell 是我们本文要研究的。</p><h2 id="准备一个项目"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#准备一个项目"><span class="icon icon-link"></span></a>准备一个项目</h2><p>我这边已经准备好了一个简单的 Deno 项目 <a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/seve">youngjuning/seve<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。如果你对 Deno 开发感兴趣，可以阅读 <a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/post/6854573220432248839">Deno 从入门到跑路 | 🏆 技术专题第一期征文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 入门。</p><h3 id="编译项目"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#编译项目"><span class="icon icon-link"></span></a>编译项目</h3><p>我们可以使用 <code>deno compile --unstable --target=&lt;target&gt;</code> 命令把我们的项目编译成二进制可执行文件，可选的 target 有：</p><ul><li>x86_64-unknown-linux-gnu</li><li>x86_64-pc-windows-msvc</li><li>x86_64-apple-darwin</li><li>aarch64-apple-darwin</li></ul><p>我们编写一个 <code>compile.sh</code> 来批量编译出各个平台的产物（记得执行 <code>chmod +x 755 compile.sh</code> 赋予脚本可执行权限）。</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#!/bin/bash</span></div><div class="token-line"><span class="token plain">name=&quot;seve&quot;</span></div><div class="token-line"><span class="token plain">deno compile --unstable --lite --target=x86_64-unknown-linux-gnu index.ts</span></div><div class="token-line"><span class="token plain">zip -o -q -m ${name}-x86_64-unknown-linux-gnu.zip ${name}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">deno compile --unstable --lite --target=x86_64-pc-windows-msvc -o ./${name}.exe index.ts</span></div><div class="token-line"><span class="token plain">zip -o -q -m ${name}-x86_64-pc-windows-msvc.zip ${name}.exe</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">deno compile --unstable --lite --target=x86_64-apple-darwin index.ts</span></div><div class="token-line"><span class="token plain">zip -o -q -m ${name}-x86_64-apple-darwin.zip ${name}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">deno compile --unstable --lite --target=aarch64-apple-darwin index.ts</span></div><div class="token-line"><span class="token plain">zip -o -q -m ${name}-aarch64-apple-darwin.zip ${name}</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>以上脚本会生成以下文件，我们不需要把它们上传到代码库中，所以请在 <code>.gitignore</code> 中忽略它们。</p><p><img src="https://i.loli.net/2021/02/02/M3QBNCJWqUfYh8Z.png" alt=""/></p><h2 id="windows-安装脚本"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#windows-安装脚本"><span class="icon icon-link"></span></a>Windows 安装脚本</h2><p>首先我们来看下 deno_install 中的脚本 <code>install.ps1</code>：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#!/usr/bin/env pwsh</span></div><div class="token-line"><span class="token plain"># Copyright 2018 the Deno authors. All rights reserved. MIT license.</span></div><div class="token-line"><span class="token plain"># TODO(everyone): Keep this script simple and easily auditable.</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$ErrorActionPreference = &#x27;Stop&#x27;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if ($v) {</span></div><div class="token-line"><span class="token plain">  $Version = &quot;v${v}&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">if ($args.Length -eq 1) {</span></div><div class="token-line"><span class="token plain">  $Version = $args.Get(0)</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$DenoInstall = $env:DENO_INSTALL</span></div><div class="token-line"><span class="token plain">$BinDir = if ($DenoInstall) {</span></div><div class="token-line"><span class="token plain">  &quot;$DenoInstall\bin&quot;</span></div><div class="token-line"><span class="token plain">} else {</span></div><div class="token-line"><span class="token plain">  &quot;$Home\.deno\bin&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$DenoZip = &quot;$BinDir\deno.zip&quot;</span></div><div class="token-line"><span class="token plain">$DenoExe = &quot;$BinDir\deno.exe&quot;</span></div><div class="token-line"><span class="token plain">$Target = &#x27;x86_64-pc-windows-msvc&#x27;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"># GitHub requires TLS 1.2</span></div><div class="token-line"><span class="token plain">[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$DenoUri = if (!$Version) {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/denoland/deno/releases/latest/download/deno-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">} else {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/denoland/deno/releases/download/${Version}/deno-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if (!(Test-Path $BinDir)) {</span></div><div class="token-line"><span class="token plain">  New-Item $BinDir -ItemType Directory | Out-Null</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Invoke-WebRequest $DenoUri -OutFile $DenoZip -UseBasicParsing</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if (Get-Command Expand-Archive -ErrorAction SilentlyContinue) {</span></div><div class="token-line"><span class="token plain">  Expand-Archive $DenoZip -Destination $BinDir -Force</span></div><div class="token-line"><span class="token plain">} else {</span></div><div class="token-line"><span class="token plain">  if (Test-Path $DenoExe) {</span></div><div class="token-line"><span class="token plain">    Remove-Item $DenoExe</span></div><div class="token-line"><span class="token plain">  }</span></div><div class="token-line"><span class="token plain">  Add-Type -AssemblyName System.IO.Compression.FileSystem</span></div><div class="token-line"><span class="token plain">  [IO.Compression.ZipFile]::ExtractToDirectory($DenoZip, $BinDir)</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Remove-Item $DenoZip</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$User = [EnvironmentVariableTarget]::User</span></div><div class="token-line"><span class="token plain">$Path = [Environment]::GetEnvironmentVariable(&#x27;Path&#x27;, $User)</span></div><div class="token-line"><span class="token plain">if (!(&quot;;$Path;&quot;.ToLower() -like &quot;*;$BinDir;*&quot;.ToLower())) {</span></div><div class="token-line"><span class="token plain">  [Environment]::SetEnvironmentVariable(&#x27;Path&#x27;, &quot;$Path;$BinDir&quot;, $User)</span></div><div class="token-line"><span class="token plain">  $Env:Path += &quot;;$BinDir&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Write-Output &quot;Deno was installed successfully to $DenoExe&quot;</span></div><div class="token-line"><span class="token plain">Write-Output &quot;Run &#x27;deno --help&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>这是 <a target="_blank" rel="noopener noreferrer" href="https://docs.microsoft.com/zh-cn/powershell/?view=powershell-7.1">powershell 文件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这里不做过多语法解释，我们看其中的核心代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">...</span></div><div class="token-line"><span class="token plain">$Target = &#x27;x86_64-pc-windows-msvc&#x27;</span></div><div class="token-line"><span class="token plain">...</span></div><div class="token-line"><span class="token plain">$DenoUri = if (!$Version) {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/denoland/deno/releases/latest/download/deno-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">} else {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/denoland/deno/releases/download/${Version}/deno-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>从这个可以看出，deno 的安装包是以 zip 的形式存在 GitHub Release 的，并且依托 Tag 实现了版本管理。下图便是 Deno 1.7.1 release 的附件：</p><p><img src="https://i.loli.net/2021/02/02/zZ8qnam3f6G4pMU.png" alt=""/></p><blockquote><p>Deno 从构建到发布这些步骤全都是 GitHub Action 自动实现的，感兴趣的我可以再写一篇解析 Deno 的自动化流程。</p></blockquote><h3 id="自定义安装脚本"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#自定义安装脚本"><span class="icon icon-link"></span></a>自定义安装脚本</h3><p>1、手动新建一个 <a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/seve/releases/tag/v0.0.1">Release<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 并把上面编译出来的压缩包以附件的形式上传：</p><p><img src="https://i.loli.net/2021/02/02/YS51VeLclnJibqz.png" alt=""/></p><p>2、将上面的脚本中的命名改成我们自己的脚本：</p><blockquote><p>如果你有 cdn 可以把它上传到 cdn 上，我这里就上传到 github 上了。</p></blockquote><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#!/usr/bin/env pwsh</span></div><div class="token-line"><span class="token plain"># Copyright 2018 the Seve authors. All rights reserved. MIT license.</span></div><div class="token-line"><span class="token plain"># TODO(everyone): Keep this script simple and easily auditable.</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$ErrorActionPreference = &#x27;Stop&#x27;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if ($v) {</span></div><div class="token-line"><span class="token plain">  $Version = &quot;v${v}&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">if ($args.Length -eq 1) {</span></div><div class="token-line"><span class="token plain">  $Version = $args.Get(0)</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$SeveInstall = $env:SEVE_INSTALL</span></div><div class="token-line"><span class="token plain">$BinDir = if ($SeveInstall) {</span></div><div class="token-line"><span class="token plain">  &quot;$SeveInstall\bin&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">else {</span></div><div class="token-line"><span class="token plain">  &quot;$Home\.seve\bin&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$SeveZip = &quot;$BinDir\seve.zip&quot;</span></div><div class="token-line"><span class="token plain">$SeveExe = &quot;$BinDir\seve.exe&quot;</span></div><div class="token-line"><span class="token plain">$Target = &#x27;x86_64-pc-windows-msvc&#x27;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"># GitHub requires TLS 1.2</span></div><div class="token-line"><span class="token plain">[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$DenoUri = if (!$Version) {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/youngjuning/seve/releases/latest/download/seve-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">else {</span></div><div class="token-line"><span class="token plain">  &quot;https://github.com/youngjuning/seve/releases/download/${Version}/seve-${Target}.zip&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if (!(Test-Path $BinDir)) {</span></div><div class="token-line"><span class="token plain">  New-Item $BinDir -ItemType Directory | Out-Null</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Invoke-WebRequest $DenoUri -OutFile $SeveZip -UseBasicParsing</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if (Get-Command Expand-Archive -ErrorAction SilentlyContinue) {</span></div><div class="token-line"><span class="token plain">  Expand-Archive $SeveZip -Destination $BinDir -Force</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">else {</span></div><div class="token-line"><span class="token plain">  if (Test-Path $SeveExe) {</span></div><div class="token-line"><span class="token plain">    Remove-Item $SeveExe</span></div><div class="token-line"><span class="token plain">  }</span></div><div class="token-line"><span class="token plain">  Add-Type -AssemblyName System.IO.Compression.FileSystem</span></div><div class="token-line"><span class="token plain">  [IO.Compression.ZipFile]::ExtractToDirectory($SeveZip, $BinDir)</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Remove-Item $SeveZip</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$User = [EnvironmentVariableTarget]::User</span></div><div class="token-line"><span class="token plain">$Path = [Environment]::GetEnvironmentVariable(&#x27;Path&#x27;, $User)</span></div><div class="token-line"><span class="token plain">if (!(&quot;;$Path;&quot;.ToLower() -like &quot;*;$BinDir;*&quot;.ToLower())) {</span></div><div class="token-line"><span class="token plain">  [Environment]::SetEnvironmentVariable(&#x27;Path&#x27;, &quot;$Path;$BinDir&quot;, $User)</span></div><div class="token-line"><span class="token plain">  $Env:Path += &quot;;$BinDir&quot;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Write-Output &quot;Seve was installed successfully to $SeveExe&quot;</span></div><div class="token-line"><span class="token plain">Write-Output &quot;Run &#x27;seve --help&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>3、安装脚本</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain"># 安装最新版</span></div><div class="token-line"><span class="token plain">iwr https://youngjuning.js.org/seve/install.ps1 -useb | iex</span></div><div class="token-line"><span class="token plain"># 安装指定版本</span></div><div class="token-line"><span class="token plain">$v=&quot;1.0.0&quot;; iwr https://deno.land/x/install/install.ps1 -useb | iex</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h2 id="类-unix-安装脚本"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#类-unix-安装脚本"><span class="icon icon-link"></span></a>类 Unix 安装脚本</h2><p>首先我们来看下 deno_install 中的脚本 <code>install.sh</code>：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#!/bin/sh</span></div><div class="token-line"><span class="token plain"># Copyright 2019 the Deno authors. All rights reserved. MIT license.</span></div><div class="token-line"><span class="token plain"># TODO(everyone): Keep this script simple and easily auditable.</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">set -e</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if ! command -v unzip &gt;/dev/null; then</span></div><div class="token-line"><span class="token plain">	echo &quot;Error: unzip is required to install Deno (see: https://github.com/denoland/deno_install#unzip-is-required).&quot; 1&gt;&amp;2</span></div><div class="token-line"><span class="token plain">	exit 1</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ &quot;$OS&quot; = &quot;Windows_NT&quot; ]; then</span></div><div class="token-line"><span class="token plain">	target=&quot;x86_64-pc-windows-msvc&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	case $(uname -sm) in</span></div><div class="token-line"><span class="token plain">	&quot;Darwin x86_64&quot;) target=&quot;x86_64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	&quot;Darwin arm64&quot;) target=&quot;aarch64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	*) target=&quot;x86_64-unknown-linux-gnu&quot; ;;</span></div><div class="token-line"><span class="token plain">	esac</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ $# -eq 0 ]; then</span></div><div class="token-line"><span class="token plain">	deno_uri=&quot;https://github.com/denoland/deno/releases/latest/download/deno-${target}.zip&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	deno_uri=&quot;https://github.com/denoland/deno/releases/download/${1}/deno-${target}.zip&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">deno_install=&quot;${DENO_INSTALL:-$HOME/.deno}&quot;</span></div><div class="token-line"><span class="token plain">bin_dir=&quot;$deno_install/bin&quot;</span></div><div class="token-line"><span class="token plain">exe=&quot;$bin_dir/deno&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ ! -d &quot;$bin_dir&quot; ]; then</span></div><div class="token-line"><span class="token plain">	mkdir -p &quot;$bin_dir&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">curl --fail --location --progress-bar --output &quot;$exe.zip&quot; &quot;$deno_uri&quot;</span></div><div class="token-line"><span class="token plain">unzip -d &quot;$bin_dir&quot; -o &quot;$exe.zip&quot;</span></div><div class="token-line"><span class="token plain">chmod +x &quot;$exe&quot;</span></div><div class="token-line"><span class="token plain">rm &quot;$exe.zip&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">echo &quot;Deno was installed successfully to $exe&quot;</span></div><div class="token-line"><span class="token plain">if command -v deno &gt;/dev/null; then</span></div><div class="token-line"><span class="token plain">	echo &quot;Run &#x27;deno --help&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	case $SHELL in</span></div><div class="token-line"><span class="token plain">	/bin/zsh) shell_profile=&quot;.zshrc&quot; ;;</span></div><div class="token-line"><span class="token plain">	*) shell_profile=&quot;.bash_profile&quot; ;;</span></div><div class="token-line"><span class="token plain">	esac</span></div><div class="token-line"><span class="token plain">	echo &quot;Manually add the directory to your \$HOME/$shell_profile (or similar)&quot;</span></div><div class="token-line"><span class="token plain">	echo &quot;  export DENO_INSTALL=\&quot;$deno_install\&quot;&quot;</span></div><div class="token-line"><span class="token plain">	echo &quot;  export PATH=\&quot;\$DENO_INSTALL/bin:\$PATH\&quot;&quot;</span></div><div class="token-line"><span class="token plain">	echo &quot;Run &#x27;$exe --help&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>上面的安装脚本就是我们熟悉的 Shell 脚本了，核心代码：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">if [ &quot;$OS&quot; = &quot;Windows_NT&quot; ]; then</span></div><div class="token-line"><span class="token plain">	target=&quot;x86_64-pc-windows-msvc&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	case $(uname -sm) in</span></div><div class="token-line"><span class="token plain">	&quot;Darwin x86_64&quot;) target=&quot;x86_64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	&quot;Darwin arm64&quot;) target=&quot;aarch64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	*) target=&quot;x86_64-unknown-linux-gnu&quot; ;;</span></div><div class="token-line"><span class="token plain">	esac</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>可以看出 <code>$(uname -sm)</code> 表示系统架构，根据它脚本可以动态决定安装哪个平台的脚本。</p><h3 id="自定义脚本"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#自定义脚本"><span class="icon icon-link"></span></a>自定义脚本</h3><blockquote><p>发布 Release 和上传附件前面说过你了，这里不多赘述了。</p></blockquote><p>1、将上面的脚本中的命名改成我们自己的脚本并上传到合适的地方：</p><blockquote><p>这里我们加入了自动设置环境变量的功能。PS：Deno 作者为了保持脚本的简洁拒绝了我的 PR。</p></blockquote><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">#!/bin/sh</span></div><div class="token-line"><span class="token plain"># Copyright 2021 the Seve authors. All rights reserved. MIT license.</span></div><div class="token-line"><span class="token plain"># TODO(everyone): Keep this script simple and easily auditable.</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">set -e</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if ! command -v unzip &gt;/dev/null; then</span></div><div class="token-line"><span class="token plain">	echo &quot;Error: unzip is required to install Seve (see: https://github.com/youngjuning/seve#unzip-is-required).&quot; 1&gt;&amp;2</span></div><div class="token-line"><span class="token plain">	exit 1</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ &quot;$OS&quot; = &quot;Windows_NT&quot; ]; then</span></div><div class="token-line"><span class="token plain">	target=&quot;x86_64-pc-windows-msvc&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	case $(uname -sm) in</span></div><div class="token-line"><span class="token plain">	&quot;Darwin x86_64&quot;) target=&quot;x86_64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	&quot;Darwin arm64&quot;) target=&quot;aarch64-apple-darwin&quot; ;;</span></div><div class="token-line"><span class="token plain">	*) target=&quot;x86_64-unknown-linux-gnu&quot; ;;</span></div><div class="token-line"><span class="token plain">	esac</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ $# -eq 0 ]; then</span></div><div class="token-line"><span class="token plain">	seve_uri=&quot;https://github.com/youngjuning/seve/releases/latest/download/seve-${target}.zip&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	seve_uri=&quot;https://github.com/youngjuning/seve/releases/download/${1}/seve-${target}.zip&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">seve_install=&quot;${SEVE_INSTALL:-$HOME/.seve}&quot;</span></div><div class="token-line"><span class="token plain">bin_dir=&quot;$seve_install/bin&quot;</span></div><div class="token-line"><span class="token plain">exe=&quot;$bin_dir/seve&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">if [ ! -d &quot;$bin_dir&quot; ]; then</span></div><div class="token-line"><span class="token plain">	mkdir -p &quot;$bin_dir&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">curl --fail --location --progress-bar --output &quot;$exe.zip&quot; &quot;$seve_uri&quot;</span></div><div class="token-line"><span class="token plain">unzip -d &quot;$bin_dir&quot; -o &quot;$exe.zip&quot;</span></div><div class="token-line"><span class="token plain">chmod +x &quot;$exe&quot;</span></div><div class="token-line"><span class="token plain">rm &quot;$exe.zip&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">echo &quot;Seve was installed successfully to $exe&quot;</span></div><div class="token-line"><span class="token plain">if command -v seve &gt;/dev/null; then</span></div><div class="token-line"><span class="token plain">	echo &quot;Run &#x27;seve --help&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">else</span></div><div class="token-line"><span class="token plain">	case $SHELL in</span></div><div class="token-line"><span class="token plain">	/bin/zsh) shell_profile=&quot;.zshrc&quot; ;;</span></div><div class="token-line"><span class="token plain">	*) shell_profile=&quot;.bash_profile&quot; ;;</span></div><div class="token-line"><span class="token plain">	esac</span></div><div class="token-line"><span class="token plain">	echo &quot;# Seve&quot; &gt;&gt; $HOME/$shell_profile</span></div><div class="token-line"><span class="token plain">	echo &quot;export SEVE_INSTALL=\&quot;$seve_install\&quot;&quot; &gt;&gt; $HOME/$shell_profile</span></div><div class="token-line"><span class="token plain">	echo &quot;export PATH=\&quot;\$SEVE_INSTALL/bin:\$PATH\&quot;&quot; &gt;&gt; $HOME/$shell_profile</span></div><div class="token-line"><span class="token plain">	source $HOME/$shell_profile</span></div><div class="token-line"><span class="token plain">	echo &quot;Run &#x27;seve&#x27; to get started&quot;</span></div><div class="token-line"><span class="token plain">fi</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>2、安装脚本</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain"># 安装最新版</span></div><div class="token-line"><span class="token plain">curl -fsSL https://youngjuning.js.org/seve/install.sh | sh</span></div><div class="token-line"><span class="token plain"># 安装指定版本</span></div><div class="token-line"><span class="token plain">curl -fsSL https://youngjuning.js.org/seve/install.sh | sh -s v0.0.1</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><blockquote><p>至此我们就实现了我们自己的脚本管理，示例代码在 <a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/seve">youngjuning/seve<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，如有帮助，欢迎 Star。</p></blockquote><h2 id="国内加速"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#国内加速"><span class="icon icon-link"></span></a>国内加速</h2><p>这又是另一段故事了，我们可以仿照 justjavac 大佬在 <a target="_blank" rel="noopener noreferrer" href="https://github.com/justjavac/deno_releases">justjavac/deno_releases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中做的那样仿照一份。和原脚本不一样的地方在于是基于 <a target="_blank" rel="noopener noreferrer" href="https://www.jsdelivr.com/">jsdelivr<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 做了 CDN 加速。</p><blockquote><p>由于 jsdeliver 有 20M 的限制，我在 coding 上开了个仓库，可以使用 <code>https://youngjuning.js.org/deno/install.sh</code> 和 <code>https://youngjuning.js.org/deno/install.ps1</code> 脚本来安装。感谢评论区大佬提醒。使用方式和 deno 一致，替换链接即可。</p></blockquote><h2 id="预告"><a aria-hidden="true" tabindex="-1" href="/blog/deno/向 deno 学习脚本的管理#预告"><span class="icon icon-link"></span></a>预告</h2><ul><li>Powershell 编程基础</li><li>Deno GitHub Action 自动化流程解析</li><li>Deno CLI 开发入门</li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io/edit/main/docs/blog/deno/向 Deno 学习脚本的管理.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">3/9/2021 02:51:45</span></div></div><div class="ant-back-top"></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.168043c5.js"></script>
  </body>
</html>
