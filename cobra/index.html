<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta name="title" content="洛竹的官方网站" />
    <meta name="keywords" content="react, javascript, typescript" />
    <meta name="description" content="怕什么真理无穷，进一寸有一寸的欢喜" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png"
    />
    <link rel="stylesheet" href="/umi.26fedac2.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.9
    </script>
    <script>
      !(function () {
        var e = localStorage.getItem("dumi:prefers-color"),
          t = window.matchMedia("(prefers-color-scheme: dark)").matches,
          r = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === r[2] ? (t ? r[1] : r[0]) : r.includes(e) ? e : r[0]
        );
      })();
    </script>
    <title>Cobra 中文文档</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/cobra" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/">洛竹的官方网站</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/blog">博客</a></span><span><a href="/awesome">收藏</a></span><span><a href="/about">关于</a></span><span><a href="/leetcode">算法</a></span><span><a href="/links">友链</a></span><span>洛竹文档⤵️<ul><li><a aria-current="page" class="active" href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/"></a><h1>洛竹的官方网站</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/blog">博客</a></li><li><a href="/awesome">收藏</a></li><li><a href="/about">关于</a></li><li><a href="/leetcode">算法</a></li><li><a href="/links">友链</a></li><li>洛竹文档⤵️<ul><li><a aria-current="page" class="active" href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/cobra">Cobra 中文文档</a></li><li><a href="/cobra/bash_completions">Bash Completions</a></li><li><a href="/cobra/generator">generator</a></li><li><a href="/cobra/man_docs">Man Pages</a></li><li><a href="/cobra/md_docs">Markdown Docs</a></li><li><a href="/cobra/pflag">pflag</a></li><li><a href="/cobra/rest_docs">ReStructured Text Docs</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="关于" data-depth="2"><a href="/cobra#关于"><span>关于</span></a></li><li title="特性" data-depth="2"><a href="/cobra#特性"><span>特性</span></a></li><li title="安装" data-depth="2"><a href="/cobra#安装"><span>安装</span></a></li><li title="概念" data-depth="2"><a href="/cobra#概念"><span>概念</span></a></li><li title="命令（Command）" data-depth="3"><a href="/cobra#命令（command）"><span>命令（Command）</span></a></li><li title="标志（Flags）" data-depth="3"><a href="/cobra#标志（flags）"><span>标志（Flags）</span></a></li><li title="入门" data-depth="2"><a href="/cobra#入门"><span>入门</span></a></li><li title="使用 Cobra 生成器" data-depth="3"><a href="/cobra#使用-cobra-生成器"><span>使用 Cobra 生成器</span></a></li><li title="使用 Cobra 库" data-depth="3"><a href="/cobra#使用-cobra-库"><span>使用 Cobra 库</span></a></li><li title="创建 main.go" data-depth="3"><a href="/cobra#创建-maingo"><span>创建 main.go</span></a></li><li title="创建额外的命令" data-depth="3"><a href="/cobra#创建额外的命令"><span>创建额外的命令</span></a></li><li title="使用标志" data-depth="3"><a href="/cobra#使用标志"><span>使用标志</span></a></li><li title="位置和自定义参数" data-depth="3"><a href="/cobra#位置和自定义参数"><span>位置和自定义参数</span></a></li><li title="示例" data-depth="3"><a href="/cobra#示例"><span>示例</span></a></li><li title="帮助命令" data-depth="3"><a href="/cobra#帮助命令"><span>帮助命令</span></a></li><li title="使用信息" data-depth="3"><a href="/cobra#使用信息"><span>使用信息</span></a></li><li title="版本标志" data-depth="3"><a href="/cobra#版本标志"><span>版本标志</span></a></li><li title="PreRun 和 PostRun Hooks" data-depth="3"><a href="/cobra#prerun-和-postrun-hooks"><span>PreRun 和 PostRun Hooks</span></a></li><li title="&quot;unknown command&quot; 时的提示" data-depth="3"><a href="/cobra#unknown-command-时的提示"><span>&quot;unknown command&quot; 时的提示</span></a></li><li title="为你的命令生成文档" data-depth="3"><a href="/cobra#为你的命令生成文档"><span>为你的命令生成文档</span></a></li><li title="为你的命令生成 Bash Completions" data-depth="3"><a href="/cobra#为你的命令生成-bash-completions"><span>为你的命令生成 Bash Completions</span></a></li></ul><div class="__dumi-default-layout-content"><div style="display:flex;justify-content:center"><img src="https://i.loli.net/2021/02/02/skn4I8acrQuMOqK.png" width="70%"/></div><div class="markdown"><div class="__dumi-default-alert" type="warning">本人非专业翻译，也非专业 Go 开发，文档若有谬误，请勿对线，直接 <a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io/edit/main/docs/cobra/index.md">编辑<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。原文档请 <a target="_blank" rel="noopener noreferrer" href="https://cobra.dev/">点击<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 查看。</div><h2 id="关于"><a aria-hidden="true" tabindex="-1" href="/cobra#关于"><span class="icon icon-link"></span></a>关于</h2><p>Cobra 是 Go 的 CLI 框架。它包含一个用于创建功能强大的现代 CLI 应用程序的库，以及一个用于快速生成基于 Cobra 的应用程序和命令文件的工具。</p><p>Cobra 由 Go 项目成员和 hugo 作者 <a target="_blank" rel="noopener noreferrer" href="https://github.com/spf13">spf13<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 创建，已经被许多流行的 Go 项目采用，比如 <a target="_blank" rel="noopener noreferrer" href="https://github.com/cli/cli">GitHub CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a target="_blank" rel="noopener noreferrer" href="https://github.com/docker/cli">Docker CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><h2 id="特性"><a aria-hidden="true" tabindex="-1" href="/cobra#特性"><span class="icon icon-link"></span></a>特性</h2><ul><li>简单的基于子命令的 CLIs：<code>app server</code>、<code>app fetch</code> 等；</li><li>完全兼容 <a target="_blank" rel="noopener noreferrer" href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3">POSIX（可移植操作系统接口）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的标志（包括短版和长版）</li><li>嵌套子命令</li><li>全局、局部和级联的标志</li><li>使用 <code>cobra init appname</code> 和 <code>cobra add cmdname</code> 轻松生成应用程序和命令</li><li>智能提示（<code>app srver</code> ...did you mean <code>app server</code>）</li><li>自动生成命令和标志的帮助</li><li>自动识别 <code>-h</code>、<code>--help</code> 等帮助标识</li><li>自动为你的应用程序生成的 bash 自动完成</li><li>自动为你的应用程序生成 man 手册</li><li>命令别名，以便你可以更改内容而不会破坏它们</li><li>定义自己的帮助，用法等的灵活性。</li><li>可选与 <a target="_blank" rel="noopener noreferrer" href="https://github.com/spf13/viper">viper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 紧密集成，可用于 <a target="_blank" rel="noopener noreferrer" href="https://12factor.net/zh_cn/">12factor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 应用程序</li></ul><h2 id="安装"><a aria-hidden="true" tabindex="-1" href="/cobra#安装"><span class="icon icon-link"></span></a>安装</h2><p>Cobra 非常易用，首先使用 <code>go get</code> 命令安装最新版本。此命令将安装 <code>cobra</code> generator 的可执行文件及其依赖项：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ go get -u github.com/spf13/cobra/cobra</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h2 id="概念"><a aria-hidden="true" tabindex="-1" href="/cobra#概念"><span class="icon icon-link"></span></a>概念</h2><p>Cobra 构建在命令（commands）、参数（arguments）和 标志（flags）上。</p><p><strong>Commands</strong> 代表动作，<strong>Args</strong> 是事物，<strong>Flags</strong> 是这些动作的修饰符。</p><p>最好的应用程序在使用时会像句子一样读起来。用户将知道如何使用该应用程序，因为他们将自然地了解如何使用它。</p><p>遵循的模式是 <code>APPNAME VERB NOUN --ADJECTIVE</code>。 或 <code>APPNAME COMMAND ARG --FLAG</code></p><p>一些真实的例子可以更好地说明这一点。</p><p>在以下示例中，<code>server</code> 是命令，<code>port</code> 是标志：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">hugo server --port=1313</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>在此命令中，我们告诉 Git 克隆 url 的内容：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">git clone URL --bare</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="命令（command）"><a aria-hidden="true" tabindex="-1" href="/cobra#命令（command）"><span class="icon icon-link"></span></a>命令（Command）</h3><p>命令是应用程序的核心。应用程序提供的每一个交互都包含在 Command 中。一个命令可以有子命令和可选的运行一个动作。</p><p>在上面的示例中，<code>server</code> 是命令。</p><p><a target="_blank" rel="noopener noreferrer" href="https://godoc.org/github.com/spf13/cobra#Command">cobra.Command API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><h3 id="标志（flags）"><a aria-hidden="true" tabindex="-1" href="/cobra#标志（flags）"><span class="icon icon-link"></span></a>标志（Flags）</h3><p>一个标志是一种修饰命令行为的方式。Cobra 支持完全符合 <a target="_blank" rel="noopener noreferrer" href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3">POSIX（可移植操作系统接口）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的标志和 Go <a target="_blank" rel="noopener noreferrer" href="https://golang.org/pkg/flag/">flag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 包。</p><p>Cobra 命令可以定义一直保留到子命令的标志和仅可用于该命令的标志。</p><p>在上面的例子中，<code>port</code> 是标志。</p><p>标志的功能是 <a target="_blank" rel="noopener noreferrer" href="https://github.com/spf13/pflag">pflag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 库提供的，该库是一个标准库的 fork，在维护相同接口的基础上兼容了 <a target="_blank" rel="noopener noreferrer" href="https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3">POSIX（可移植操作系统接口）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><h2 id="入门"><a aria-hidden="true" tabindex="-1" href="/cobra#入门"><span class="icon icon-link"></span></a>入门</h2><p>欢迎大家提供自己的项目组织结构，但是通常基于 Cobra 的应用程序将遵循以下组织结构</p><div class="ant-tree ant-tree-block-node ant-tree-unselectable ant-tree-directory __dumi-site-tree ant-tree-show-line"><div role="tree"><input style="width:0;height:0;display:flex;overflow:hidden;opacity:0;border:0;padding:0;margin:0" tabindex="0" value=""/></div><div class="ant-tree-treenode" aria-hidden="true" style="position:absolute;pointer-events:none;visibility:hidden;height:0;overflow:hidden"><div class="ant-tree-indent"><div class="ant-tree-indent-unit"></div></div></div><div style="position:relative" class="ant-tree-list"><div class="ant-tree-list-holder"><div><div style="display:flex;flex-direction:column" class="ant-tree-list-holder-inner"><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"></span><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="minus-square" class="anticon anticon-minus-square ant-tree-switcher-line-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="minus-square" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"></path><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"></path></svg></span></span><span title="appName" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="folder-open" class="anticon anticon-folder-open"><svg viewBox="64 64 896 896" focusable="false" data-icon="folder-open" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"></path></svg></span></span><span class="ant-tree-title">appName</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="minus-square" class="anticon anticon-minus-square ant-tree-switcher-line-icon"><svg viewBox="64 64 896 896" focusable="false" data-icon="minus-square" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"></path><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"></path></svg></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="folder-open" class="anticon anticon-folder-open"><svg viewBox="64 64 896 896" focusable="false" data-icon="folder-open" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"></path></svg></span></span><span class="ant-tree-title">cmd<small>放置命令的文件夹</small></span></span></div><div class="ant-tree-treenode"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"><span class="ant-tree-switcher-leaf-line"></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="file" class="anticon anticon-file"><svg viewBox="64 64 896 896" focusable="false" data-icon="file" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"></path></svg></span></span><span class="ant-tree-title">add.go</span></span></div><div class="ant-tree-treenode"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"><span class="ant-tree-switcher-leaf-line"></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="file" class="anticon anticon-file"><svg viewBox="64 64 896 896" focusable="false" data-icon="file" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"></path></svg></span></span><span class="ant-tree-title">your.go</span></span></div><div class="ant-tree-treenode"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"><span class="ant-tree-switcher-leaf-line"></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="file" class="anticon anticon-file"><svg viewBox="64 64 896 896" focusable="false" data-icon="file" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"></path></svg></span></span><span class="ant-tree-title">commands.go</span></span></div><div class="ant-tree-treenode ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"><span class="ant-tree-switcher-leaf-line"></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="file" class="anticon anticon-file"><svg viewBox="64 64 896 896" focusable="false" data-icon="file" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"></path></svg></span></span><span class="ant-tree-title">here.go</span></span></div><div class="ant-tree-treenode ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"><span class="ant-tree-switcher-leaf-line"></span></span><span title="" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-iconEle ant-tree-icon__customize"><span role="img" aria-label="file" class="anticon anticon-file"><svg viewBox="64 64 896 896" focusable="false" data-icon="file" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"></path></svg></span></span><span class="ant-tree-title">main.go<small>应用程序入口</small></span></span></div></div></div></div></div></div><p>在 Cobra 应用程序中，通常 <code>main.go</code> 文件非常。它有一个目的：初始化 Cobra。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">package</span><span class="token plain"> main</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string">&quot;{pathToYourApp}/cmd&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  cmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="使用-cobra-生成器"><a aria-hidden="true" tabindex="-1" href="/cobra#使用-cobra-生成器"><span class="icon icon-link"></span></a>使用 Cobra 生成器</h3><p>Cobra 提供了 CLI 来创建您的应用程序和添加任意你想要的命令。这是将 Cobra 集成到您的应用程序中的最简单方法。</p><p><a href="/cobra/generator">这里</a> 你可以查看更多关于生成器的资料。</p><h3 id="使用-cobra-库"><a aria-hidden="true" tabindex="-1" href="/cobra#使用-cobra-库"><span class="icon icon-link"></span></a>使用 Cobra 库</h3><p>要手动接入 Cobra，您需要创建一个 <code>main.go</code> 文件和 <code>rootCmd</code> 文件。您可以选择提供合适的其他命令。</p><h4 id="创建-rootcmd"><a aria-hidden="true" tabindex="-1" href="/cobra#创建-rootcmd"><span class="icon icon-link"></span></a>创建 rootCmd</h4><p>Cobra 不需要任何特殊的构造函数。只需创建您的命令。</p><p>理想情况下，将其放置在 <code>/cmd/root.go</code> 中：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// rootCmd 代表没有调用子命令时的基础命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> rootCmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;hugo&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Hugo is a very fast static site generator&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`A Fast and Flexible Static Site Generator built with</span></div><div class="token-line"><span class="token string">                love by spf13 and friends in Go.</span></div><div class="token-line"><span class="token string">                Complete documentation is available at http://hugo.spf13.com`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 如果有相关的 action 要执行，请取消下面这行代码的注释</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// Run: func(cmd *cobra.Command, args []string) { },</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// Execute 将所有子命令添加到root命令并适当设置标志。会被 main.main() 调用一次。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token plain">err</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		os</span><span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>您还将在 <code>init()</code> 函数中定义标志并处理配置。例子如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// cmd/root.go</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">package</span><span class="token plain"> cmd</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;os&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;github.com/spf13/cobra&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	homedir </span><span class="token string">&quot;github.com/mitchellh/go-homedir&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;github.com/spf13/viper&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> cfgFile </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> projectBase </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> userLicense </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// rootCmd 代表没有调用子命令时的基础命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> rootCmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;hugo&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Hugo is a very fast static site generator&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`A Fast and Flexible Static Site Generator built with</span></div><div class="token-line"><span class="token string">                love by spf13 and friends in Go.</span></div><div class="token-line"><span class="token string">                Complete documentation is available at http://hugo.spf13.com`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 如果有相关的 action 要执行，请取消下面这行代码的注释</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// Run: func(cmd *cobra.Command, args []string) { },</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// Execute 添加所有的子命令到根命令并适当地设置标志</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 这由 main.main() 调用。它只需要对 rootCmd 调用一次。</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token plain">err</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		os</span><span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	cobra</span><span class="token punctuation">.</span><span class="token function">OnInitialize</span><span class="token punctuation">(</span><span class="token plain">initConfig</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">cfgFile</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;config&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;config file (default is $HOME/.cobra.yaml)&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">projectBase</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;projectbase&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;base project directory eg. github.com/spf13/&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringP</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;YOUR NAME&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;Author name for copyright attribution&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">userLicense</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;license&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;l&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;Name of license for the project (can provide `licensetext` in config)&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Bool</span><span class="token punctuation">(</span><span class="token string">&quot;viper&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;Use Viper for configuration&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	viper</span><span class="token punctuation">.</span><span class="token function">BindPFlag</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Lookup</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	viper</span><span class="token punctuation">.</span><span class="token function">BindPFlag</span><span class="token punctuation">(</span><span class="token string">&quot;projectbase&quot;</span><span class="token punctuation">,</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Lookup</span><span class="token punctuation">(</span><span class="token string">&quot;projectbase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	viper</span><span class="token punctuation">.</span><span class="token function">BindPFlag</span><span class="token punctuation">(</span><span class="token string">&quot;useViper&quot;</span><span class="token punctuation">,</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Lookup</span><span class="token punctuation">(</span><span class="token string">&quot;viper&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	viper</span><span class="token punctuation">.</span><span class="token function">SetDefault</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;NAME HERE &lt;EMAIL ADDRESS&gt;&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	viper</span><span class="token punctuation">.</span><span class="token function">SetDefault</span><span class="token punctuation">(</span><span class="token string">&quot;license&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;apache&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token comment">// Don&#x27;t forget to read config either from cfgFile or from home directory!</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">if</span><span class="token plain"> cfgFile </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token comment">// Use config file from the flag.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		viper</span><span class="token punctuation">.</span><span class="token function">SetConfigFile</span><span class="token punctuation">(</span><span class="token plain">cfgFile</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token comment">// Find home directory.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		home</span><span class="token punctuation">,</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> homedir</span><span class="token punctuation">.</span><span class="token function">Dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token keyword">if</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token plain">err</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			os</span><span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">		</span><span class="token comment">// Search config in home directory with name &quot;.cobra&quot; (without extension).</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		viper</span><span class="token punctuation">.</span><span class="token function">AddConfigPath</span><span class="token punctuation">(</span><span class="token plain">home</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		viper</span><span class="token punctuation">.</span><span class="token function">SetConfigName</span><span class="token punctuation">(</span><span class="token string">&quot;.cobra&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">if</span><span class="token plain"> err </span><span class="token operator">:=</span><span class="token plain"> viper</span><span class="token punctuation">.</span><span class="token function">ReadInConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> err </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Can&#x27;t read config:&quot;</span><span class="token punctuation">,</span><span class="token plain"> err</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		os</span><span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="创建-maingo"><a aria-hidden="true" tabindex="-1" href="/cobra#创建-maingo"><span class="icon icon-link"></span></a>创建 main.go</h3><p>有了根命令，你需要一个 main 函数去执行它。为了清晰起见，<code>Execute</code> 应该在根目录上运行，尽管可以在任何命令上调用它。</p><p>在 Cobra 应用中，<code>main.go</code> 是非常简单的。它只有一个作用——初始化 Cobra。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// main.go</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">package</span><span class="token plain"> main</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string">&quot;{pathToYourApp}/cmd&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  cmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="创建额外的命令"><a aria-hidden="true" tabindex="-1" href="/cobra#创建额外的命令"><span class="icon icon-link"></span></a>创建额外的命令</h3><p>可以定义其他命令，并且通常在 <code>cmd/</code> 目录中为每个命令提供自己的文件。</p><p>如果要创建 <code>version</code> 命令，则可以创建 <code>cmd/version.go</code> 并使用以下命令进行填充：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// cmd/version.go</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">package</span><span class="token plain"> cmd</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">  </span><span class="token string">&quot;github.com/spf13/cobra&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  rootCmd</span><span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span><span class="token plain">versionCmd</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> versionCmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;version&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Print the version number of Hugo&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Long</span><span class="token punctuation">:</span><span class="token plain">  </span><span class="token string">`All software has versions. This is Hugo&#x27;s`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hugo Static Site Generator v0.9 -- HEAD&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="使用标志"><a aria-hidden="true" tabindex="-1" href="/cobra#使用标志"><span class="icon icon-link"></span></a>使用标志</h3><p>标志提供修饰符以控制命令的操作方式。</p><p>由于标志是在不同位置定义和使用的，我们需要在外部定义一个具有正确作用域的变量，以分配要使用的标志。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> verbose </span><span class="token builtin">bool</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> source </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>这里有两种不同分配标志的方法。</p><h4 id="持久标志"><a aria-hidden="true" tabindex="-1" href="/cobra#持久标志"><span class="icon icon-link"></span></a>持久标志</h4><p>标志可以是 &quot;persistent&quot; 的，这意味着该标志将可用于分配给它的命令以及该命令下的每个命令。对于全局标志，将标志分配为根上的持久标志。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BoolVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">verbose</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;verbose&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;v&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;verbose output&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h4 id="本地标志"><a aria-hidden="true" tabindex="-1" href="/cobra#本地标志"><span class="icon icon-link"></span></a>本地标志</h4><p>也可以在本地分配一个标志，该标志仅适用于该特定命令。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">rootCmd</span><span class="token punctuation">.</span><span class="token function">Flags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">source</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;Source directory to read from&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h4 id="父命令上的本地标志"><a aria-hidden="true" tabindex="-1" href="/cobra#父命令上的本地标志"><span class="icon icon-link"></span></a>父命令上的本地标志 <span class="__dumi-default-badge">🧐</span></h4><p>默认情况下，Cobra 仅解析目标命令上的本地标志，而忽略父命令上的任何本地标志。通过启用 <code>Command.TraverseChildren</code>，Cobra 将在执行目标命令之前解析每个命令上的本地标志</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">command </span><span class="token operator">:=</span><span class="token plain"> cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Use</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;print [OPTIONS] [COMMANDS]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  TraverseChildren</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h4 id="用配置绑定标志"><a aria-hidden="true" tabindex="-1" href="/cobra#用配置绑定标志"><span class="icon icon-link"></span></a>用配置绑定标志</h4><p>您还可以将标志与 <a target="_blank" rel="noopener noreferrer" href="https://github.com/spf13/viper">viper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 绑定：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> author </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVar</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">author</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;YOUR NAME&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;Author name for copyright attribution&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  viper</span><span class="token punctuation">.</span><span class="token function">BindPFlag</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span><span class="token plain"> rootCmd</span><span class="token punctuation">.</span><span class="token function">PersistentFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Lookup</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>在此示例中，持久标记 <code>author</code> 与 viper 绑定。请注意，当用户未提供 <code>--author</code> 标志时，变量 <code>author</code> 不会设置为 <code>config</code> 中的值。</p><p>更多信息请查看 <a href="/viper#%E4%B8%8E%E6%A0%87%E5%BF%97%E4%B8%80%E8%B5%B7%E4%BD%BF%E7%94%A8">viper 文档</a>。</p><h4 id="必需标志"><a aria-hidden="true" tabindex="-1" href="/cobra#必需标志"><span class="icon icon-link"></span></a>必需标志</h4><p>标志默认是可选的。如果你想在缺少标志时命令报错，请设置该标志为必需：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> region </span><span class="token builtin">string</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">rootCmd</span><span class="token punctuation">.</span><span class="token function">Flags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">StringVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">region</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;region&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;r&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;AWS region (required)&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">rootCmd</span><span class="token punctuation">.</span><span class="token function">MarkFlagRequired</span><span class="token punctuation">(</span><span class="token string">&quot;region&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="位置和自定义参数"><a aria-hidden="true" tabindex="-1" href="/cobra#位置和自定义参数"><span class="icon icon-link"></span></a>位置和自定义参数</h3><p>可以使用 Command 的 Args 字段指定位置参数的验证。</p><p>下面的验证符是内置的：</p><ul><li><code>NoArgs</code> - 如果有任何位置参数，该命令将报告错误。</li><li><code>ArbitraryArgs</code> - 命令将接受任意参数</li><li><code>OnlyValidArgs</code> - 如果 Command 的 <code>ValidArgs</code> 字段中不存在该位置参数，则该命令将报告错误。</li><li><code>MinimumNArgs(int)</code> - 如果不存在至少 N 个位置参数，则该命令将报告错误。</li><li><code>MaximumNArgs(int)</code> - 如果存在超过 N 个位置参数，则该命令将报告错误。</li><li><code>ExactArgs(int)</code> - 如果不存在 N 个位置参数，则该命令将报告错误。</li><li><code>ExactValidArgs(int)</code> - 如果没有确切的 N 个位置参数，或者如果 Command 的 ValidArgs 字段中不存在该位置参数，则该命令将报告并出错。</li><li><code>RangeArgs(min, max)</code> - 如果 args 的数目不在期望的 args 的最小和最大数目之间，则该命令将报告并出错。</li></ul><p>内置验证符使用实例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> cmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Args</span><span class="token punctuation">:</span><span class="token plain">  cobra</span><span class="token punctuation">.</span><span class="token function">MinimumNArgs</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p><div class="__dumi-default-alert" type="error">如果只传递一个位置参数会报 <code>Error: requires at least 2 arg(s), only received 1</code> 的警告。</div></p><p>设置自定义验证器的示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> cmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Args</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token function">len</span><span class="token punctuation">(</span><span class="token plain">args</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> errors</span><span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;requires at least one arg&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> myapp</span><span class="token punctuation">.</span><span class="token function">IsValidColor</span><span class="token punctuation">(</span><span class="token plain">args</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token boolean">nil</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> fmt</span><span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;invalid color specified: %s&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="示例"><a aria-hidden="true" tabindex="-1" href="/cobra#示例"><span class="icon icon-link"></span></a>示例</h3><p>在下面的例子中，我们定义了三个命令。两个在顶层，一个（<code>cmdTimes</code>）是子命令。在这种情况下，根目录不可执行，这意味着需要一个子命令。通过不为 <code>rootCmd</code> 提供 <code>Run</code> 来实现。</p><p>我们只为一个命令定义了一个标志。</p><p>关于标志的文档在 <a href="/cobra/pflag">pflag</a>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">package</span><span class="token plain"> main</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;strings&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;github.com/spf13/cobra&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> echoTimes </span><span class="token builtin">int</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> cmdPrint </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;Print [string to print]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Print anything to the screen&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`print is for printing anything back to the screen.</span></div><div class="token-line"><span class="token string">For many years people have printed back to the screen.`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Args</span><span class="token punctuation">:</span><span class="token plain"> cobra</span><span class="token punctuation">.</span><span class="token function">MinimumNArgs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Print: &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> strings</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token plain">args</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> cmdEcho </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;echo [string to echo]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Echo anything to the screen&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`echo is for echoing anything back.</span></div><div class="token-line"><span class="token string">Echo works a lot like print, except it has a child command.`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Args</span><span class="token punctuation">:</span><span class="token plain"> cobra</span><span class="token punctuation">.</span><span class="token function">MinimumNArgs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Print: &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> strings</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token plain">args</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> cmdTimes </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;times [# times] [string to echo]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;Echo anyting to the screen more times&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`echo things multiple times back to the user y providing</span></div><div class="token-line"><span class="token string">		a count and a string.`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Args</span><span class="token punctuation">:</span><span class="token plain"> cobra</span><span class="token punctuation">.</span><span class="token function">MinimumNArgs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			</span><span class="token keyword">for</span><span class="token plain"> i </span><span class="token operator">:=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"> i </span><span class="token operator">&lt;</span><span class="token plain"> echoTimes</span><span class="token punctuation">;</span><span class="token plain"> i</span><span class="token operator">++</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">				fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Echo: &quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> strings</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token plain">args</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	cmdTimes</span><span class="token punctuation">.</span><span class="token function">Flags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IntVarP</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token plain">echoTimes</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;times&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;t&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;times to echo the input&quot;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token comment">// 设置根命令</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> rootCmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain">Use</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;app&quot;</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span><span class="token plain">cmdPrint</span><span class="token punctuation">,</span><span class="token plain"> cmdEcho</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	cmdEcho</span><span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span><span class="token plain">cmdTimes</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token comment">// 初始化应用</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>更复杂的应用，请参考 <a target="_blank" rel="noopener noreferrer" href="https://github.com/gohugoio/hugo">Hugo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 或者 <a target="_blank" rel="noopener noreferrer" href="https://github.com/cli/cli">GitHub CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><h3 id="帮助命令"><a aria-hidden="true" tabindex="-1" href="/cobra#帮助命令"><span class="icon icon-link"></span></a>帮助命令</h3><p>当你添加了子命令，Cobra 会自动添加一些帮助命令。当你执行 <code>app help</code> 命令时会显示帮助信息。另外，<code>help</code> 还支持其他命令作为输入参数。举例来说，你有一个没有额外配置的 <code>create</code> 命令，<code>app help create</code> 是有效的。每一个命令还会自动获取一个 <code>--help</code> 标志。</p><h4 id="示例-1"><a aria-hidden="true" tabindex="-1" href="/cobra#示例-1"><span class="icon icon-link"></span></a>示例</h4><p>以下输出由 Cobra 自动生成。 除了命令和标志定义外，什么都不需要。</p><p><img src="https://i.loli.net/2021/02/01/Mi51jfXQE39ZFcT.png" alt=""/></p><p><code>help</code> 就像其他命令一样。并没有特殊的逻辑或行为。实际上，你可以根据需要提供自己的服务。</p><h4 id="定义你自己的-help"><a aria-hidden="true" tabindex="-1" href="/cobra#定义你自己的-help"><span class="icon icon-link"></span></a>定义你自己的 help</h4><p>你可以使用下面的方法提供你自己的 Help 命令或模板。</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token function">SetHelpCommand</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">Command</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token function">setHelpCommand</span><span class="token punctuation">(</span><span class="token plain">f </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token function">setHelpTemplate</span><span class="token punctuation">(</span><span class="token plain">s </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>后两者也适用于所有子命令。</p><h3 id="使用信息"><a aria-hidden="true" tabindex="-1" href="/cobra#使用信息"><span class="icon icon-link"></span></a>使用信息</h3><p>当用户提供无效的标志或无效的命令时，Cobra 会通过向用户显示 <code>usage</code> 进行响应。</p><p><img src="https://i.loli.net/2021/02/01/vtlzqAo7eDJwhM1.png" alt=""/></p><h4 id="定义你自己的使用信息"><a aria-hidden="true" tabindex="-1" href="/cobra#定义你自己的使用信息"><span class="icon icon-link"></span></a>定义你自己的使用信息</h4><p>你可以提供你自己的 usage 函数或模板。像 <code>help</code> 一样，函数和模板可通过公共方法重写：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token function">SetUsageFunc</span><span class="token punctuation">(</span><span class="token plain">f </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token plain">Command</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token function">SetUsageTemplate</span><span class="token punctuation">(</span><span class="token plain">s </span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>可以参考 <a target="_blank" rel="noopener noreferrer" href="https://github.com/cli/cli/blob/dcf5a27f5343ea0e9b3ef71ca37a4c3948102667/pkg/cmd/root/root.go#L63">GitHub CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的写法。</p><h3 id="版本标志"><a aria-hidden="true" tabindex="-1" href="/cobra#版本标志"><span class="icon icon-link"></span></a>版本标志</h3><p>如果给根命令设置了 <code>Version</code> 字段，Cobra 会添加一个顶级的 <code>--version</code> 标志。运行带有 <code>–version</code> 标志的应用程序，将使用版本模板将版本打印到 stdout。模板可以使用 <code>cmd.SetVersionTemplate(s string)</code> 函数自定义。</p><blockquote><p><code>SetVersionTemplate</code> 的使用可以参考 <a target="_blank" rel="noopener noreferrer" href="https://github.com/cli/cli/blob/dcf5a27f5343ea0e9b3ef71ca37a4c3948102667/pkg/cmd/root/root.go#L67">GitHub CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="prerun-和-postrun-hooks"><a aria-hidden="true" tabindex="-1" href="/cobra#prerun-和-postrun-hooks"><span class="icon icon-link"></span></a>PreRun 和 PostRun Hooks</h3><p>可以在执行命令之前和之后运行一个函数。<code>PersistentPreRun</code> 和 <code>PreRun</code> 函数将在 <code>Run</code> 之前执行。<code>PersistentPostRun</code> 和 <code>PostRun</code> 会在 <code>Run</code> 之后运行。如果子级未声明自己的 <code>Persistent * Run</code> 函数，则子级将继承父级的。这些函数的执行顺续如下：</p><ul><li>PersistentPreRun</li><li>PreRun</li><li>Run</li><li>PostRun</li><li>PersistentPostRun</li></ul><p>下面这个包含了两个命令的例子使用了这些特性。当子命令执行时，它会运行根命令的 <code>PersistentPreRun</code>，但是不会运行根命令的 <code>PersistentPostRun</code>：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">package</span><span class="token plain"> main</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	</span><span class="token string">&quot;github.com/spf13/cobra&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">func</span><span class="token plain"> </span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token keyword">var</span><span class="token plain"> rootCmd </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;root [sub]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;My root command&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PersistentPreRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside rootCmd PersistentPreRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PreRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside rootCmd PreRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside rootCmd Run with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PostRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside rootCmd PostRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PersistentPostRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside rootCmd PersistentPostRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	subCmd </span><span class="token operator">:=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;sub [no options!]&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;My subcommand&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PreRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside subCmd PreRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Run</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside subCmd Run with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PostRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside subCmd PostRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		PersistentPostRun</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token plain">cmd </span><span class="token operator">*</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">,</span><span class="token plain"> args </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">			fmt</span><span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Inside subCmd PersistentPostRun with args: %v\n&quot;</span><span class="token punctuation">,</span><span class="token plain"> args</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">AddCommand</span><span class="token punctuation">(</span><span class="token plain">subCmd</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">SetArgs</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	fmt</span><span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">SetArgs</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;sub&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;arg1&quot;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&quot;arg2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	rootCmd</span><span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>输出：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">Inside rootCmd PersistentPreRun with args: []</span></div><div class="token-line"><span class="token plain">Inside rootCmd PreRun with args: []</span></div><div class="token-line"><span class="token plain">Inside rootCmd Run with args: []</span></div><div class="token-line"><span class="token plain">Inside rootCmd PostRun with args: []</span></div><div class="token-line"><span class="token plain">Inside rootCmd PersistentPostRun with args: []</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Inside rootCmd PersistentPreRun with args: [arg1 arg2]</span></div><div class="token-line"><span class="token plain">Inside subCmd PreRun with args: [arg1 arg2]</span></div><div class="token-line"><span class="token plain">Inside subCmd Run with args: [arg1 arg2]</span></div><div class="token-line"><span class="token plain">Inside subCmd PostRun with args: [arg1 arg2]</span></div><div class="token-line"><span class="token plain">Inside subCmd PersistentPostRun with args: [arg1 arg2]</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="unknown-command-时的提示"><a aria-hidden="true" tabindex="-1" href="/cobra#unknown-command-时的提示"><span class="icon icon-link"></span></a>&quot;unknown command&quot; 时的提示</h3><p>当 <code>&quot;unknown command&quot;</code> 错误发生时，Cobra 会自动打印提示。这和 git 命令的行为一致。比如</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ hugo srever</span></div><div class="token-line"><span class="token plain">Error: unknown command &quot;srever&quot; for &quot;hugo&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Did you mean this?</span></div><div class="token-line"><span class="token plain">        server</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Run &#x27;hugo --help&#x27; for usage.</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>系统会根据注册的每个子命令自动生成建议，并使用<a target="_blank" rel="noopener noreferrer" href="https://zh.wikipedia.org/wiki/%E8%90%8A%E6%96%87%E6%96%AF%E5%9D%A6%E8%B7%9D%E9%9B%A2">萊文斯坦距離<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的实现。每个匹配最小距离 2（忽略大小写）的注册命令都将显示为建议。</p><p>如果需要禁用建议或在命令中调整字符串距离，请使用：</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token plain">DisableSuggestions </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>或</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cmd</span><span class="token punctuation">.</span><span class="token plain">SuggestionsMinimumDistance </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><p>您还可以使用 <code>SuggestFor</code> 属性显式为给定命令设置建议的名称。这样就可以针对不是距离很近的字符串提出建议，但是对于您的命令集和不希望使用别名的命令来说，它们都是有意义的。比如：</p><div class="__dumi-default-code-block"><pre class="prism-code language-sh"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ kubectl remove</span></div><div class="token-line"><span class="token plain">Error: unknown command &quot;remove&quot; for &quot;kubectl&quot;</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Did you mean this?</span></div><div class="token-line"><span class="token plain">        delete</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">Run &#x27;kubectl help&#x27; for usage.</span></div><div class="token-line"><span class="token plain">
</span></div></pre></div><h3 id="为你的命令生成文档"><a aria-hidden="true" tabindex="-1" href="/cobra#为你的命令生成文档"><span class="icon icon-link"></span></a>为你的命令生成文档</h3><p>Cobra 可以基于子命令、标志等生成文档。可用格式如下：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://youngjuning.js.org/cobra/md_docs">Markdown<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://youngjuning.js.org/cobra/rest_docs">ReStructured Text<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://youngjuning.js.org/cobra/man_docs">Man Page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h3 id="为你的命令生成-bash-completions"><a aria-hidden="true" tabindex="-1" href="/cobra#为你的命令生成-bash-completions"><span class="icon icon-link"></span></a>为你的命令生成 Bash Completions</h3><p>Cobra 可以生成 bash-completion 文件。如果你给你的命令添加了更多的信息，这些自动提示的分析会非常强大和灵活。更是信息请阅读<a target="_blank" rel="noopener noreferrer" href="https://youngjuning.js.org/cobra/bash_completions">Bash Completions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io/edit/main/docs/cobra/index.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">3/8/2021 10:19:32</span></div></div><div class="ant-back-top"></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.927749bf.js"></script>
  </body>
</html>
