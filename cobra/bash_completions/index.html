<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta name="title" content="洛竹的官方网站" />
    <meta name="keywords" content="react, javascript, typescript" />
    <meta name="description" content="怕什么真理无穷，进一寸有一寸的欢喜" />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png"
    />
    <link rel="stylesheet" href="/umi.71e30557.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.3.7
    </script>
    <title>Bash Completions</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/cobra/bash_completions" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/">洛竹的官方网站</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/blog">博客</a></span><span><a href="/awesome">收藏</a></span><span><a href="/about">关于</a></span><span><a href="/leetcode">算法</a></span><span><a href="/links">友链</a></span><span>洛竹文档⤵️<ul><li><a aria-current="page" class="active" href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><span><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;https://i.loli.net/2021/01/07/LkH3VM6oBnIuFNi.png&#x27;)" href="/"></a><h1>洛竹的官方网站</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/blog">博客</a></li><li><a href="/awesome">收藏</a></li><li><a href="/about">关于</a></li><li><a href="/leetcode">算法</a></li><li><a href="/links">友链</a></li><li>洛竹文档⤵️<ul><li><a aria-current="page" class="active" href="/cobra"> Cobra</a></li><li><a href="/viper"> Viper</a></li><li><a href="/github-actions"> GitHub Actions</a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://juejin.cn/user/325111174662855/posts">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/people/yangjunning">知乎<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><ul><li><a target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/column/c_1341734653628149760">前端早茶馆<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/cobra">Cobra 中文文档</a></li><li><a aria-current="page" class="active" href="/cobra/bash_completions">Bash Completions</a></li><li><a href="/cobra/generator">generator</a></li><li><a href="/cobra/man_docs">Man Pages</a></li><li><a href="/cobra/md_docs">Markdown Docs</a></li><li><a href="/cobra/pflag">pflag</a></li><li><a href="/cobra/rest_docs">ReStructured Text Docs</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="为你的 cobra.Command 生成 Bash Completions" data-depth="2"><a href="/cobra/bash_completions#为你的-cobracommand-生成-bash-completions"><span>为你的 cobra.Command 生成 Bash Completions</span></a></li><li title="Bash legacy dynamic completions" data-depth="2"><a href="/cobra/bash_completions#bash-legacy-dynamic-completions"><span>Bash legacy dynamic completions</span></a></li></ul><div class="__dumi-default-layout-content"><div style="display:flex;justify-content:center"><img width="70%"/></div><div class="markdown"><h2 id="为你的-cobracommand-生成-bash-completions"><a aria-hidden="true" tabindex="-1" href="/cobra/bash_completions#为你的-cobracommand-生成-bash-completions"><span class="icon,icon-link"></span></a>为你的 cobra.Command 生成 Bash Completions</h2><p>Please refer to <a href="/cobra/shell_completions">Shell Completions</a> for details.</p><h2 id="bash-legacy-dynamic-completions"><a aria-hidden="true" tabindex="-1" href="/cobra/bash_completions#bash-legacy-dynamic-completions"><span class="icon,icon-link"></span></a>Bash legacy dynamic completions</h2><p>For backwards-compatibility, Cobra still supports its legacy dynamic completion solution (described below). Unlike the <code>ValidArgsFunction</code> solution, the legacy solution will only work for Bash shell-completion and not for other shells. This legacy solution can be used along-side <code>ValidArgsFunction</code> and <code>RegisterFlagCompletionFunc()</code>, as long as both solutions are not used for the same command. This provides a path to gradually migrate from the legacy solution to the new solution.</p><p>The legacy solution allows you to inject bash functions into the bash completion script. Those bash functions are responsible for providing the completion choices for your own completions.</p><p>Some code that works in kubernetes:</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">const </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        bash_completion_func </span><span class="token operator">=</span><span class="token plain"> </span><span class="token variable">`</span><span class="token variable function-name function">__kubectl_parse_get</span><span class="token variable punctuation">(</span><span class="token variable punctuation">)</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable punctuation">{</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable builtin class-name">local</span><span class="token variable"> kubectl_output out</span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">if</span><span class="token variable"> </span><span class="token variable assign-left variable">kubectl_output</span><span class="token variable operator">=</span><span class="token variable punctuation">$(</span><span class="token variable">kubectl get --no-headers </span><span class="token variable string">&quot;</span><span class="token variable string variable">$1</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator file-descriptor important">2</span><span class="token variable operator">&gt;</span><span class="token variable">/dev/null</span><span class="token variable punctuation">)</span><span class="token variable punctuation">;</span><span class="token variable"> </span><span class="token variable keyword">then</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        </span><span class="token variable assign-left variable">out</span><span class="token variable operator">=</span><span class="token variable punctuation">(</span><span class="token variable punctuation">$(</span><span class="token variable">echo </span><span class="token variable string">&quot;</span><span class="token variable string variable">${kubectl_output}</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable operator">|</span><span class="token variable"> </span><span class="token variable function">awk</span><span class="token variable"> </span><span class="token variable string">&#x27;{print </span><span class="token variable string variable">$1</span><span class="token variable string">}&#x27;</span><span class="token variable punctuation">))</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        </span><span class="token variable assign-left variable">COMPREPLY</span><span class="token variable operator">=</span><span class="token variable punctuation">(</span><span class="token variable"> </span><span class="token variable punctuation">$(</span><span class="token variable"> compgen -W </span><span class="token variable string">&quot;</span><span class="token variable string variable">${out</span><span class="token variable string variable punctuation">[</span><span class="token variable string variable">*</span><span class="token variable string variable punctuation">]</span><span class="token variable string variable">}</span><span class="token variable string">&quot;</span><span class="token variable"> -- </span><span class="token variable string">&quot;</span><span class="token variable string variable">$cur</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable punctuation">)</span><span class="token variable"> </span><span class="token variable punctuation">)</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">fi</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable punctuation">}</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable function-name function">__kubectl_get_resource</span><span class="token variable punctuation">(</span><span class="token variable punctuation">)</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable punctuation">{</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">if</span><span class="token variable"> </span><span class="token variable punctuation">[</span><span class="token variable punctuation">[</span><span class="token variable"> $</span><span class="token variable punctuation">{</span><span class="token variable">#nouns</span><span class="token variable punctuation">[</span><span class="token variable">@</span><span class="token variable punctuation">]</span><span class="token variable punctuation">}</span><span class="token variable"> -eq </span><span class="token variable number">0</span><span class="token variable"> </span><span class="token variable punctuation">]</span><span class="token variable punctuation">]</span><span class="token variable punctuation">;</span><span class="token variable"> </span><span class="token variable keyword">then</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        </span><span class="token variable builtin class-name">return</span><span class="token variable"> </span><span class="token variable number">1</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">fi</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    __kubectl_parse_get $</span><span class="token variable punctuation">{</span><span class="token variable">nouns</span><span class="token variable punctuation">[</span><span class="token variable">$</span><span class="token variable punctuation">{</span><span class="token variable">#nouns</span><span class="token variable punctuation">[</span><span class="token variable">@</span><span class="token variable punctuation">]</span><span class="token variable punctuation">}</span><span class="token variable"> -1</span><span class="token variable punctuation">]</span><span class="token variable punctuation">}</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">if</span><span class="token variable"> </span><span class="token variable punctuation">[</span><span class="token variable punctuation">[</span><span class="token variable"> $? -eq </span><span class="token variable number">0</span><span class="token variable"> </span><span class="token variable punctuation">]</span><span class="token variable punctuation">]</span><span class="token variable punctuation">;</span><span class="token variable"> </span><span class="token variable keyword">then</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        </span><span class="token variable builtin class-name">return</span><span class="token variable"> </span><span class="token variable number">0</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">fi</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable punctuation">}</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable function-name function">__kubectl_custom_func</span><span class="token variable punctuation">(</span><span class="token variable punctuation">)</span><span class="token variable"> </span><span class="token variable punctuation">{</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">case</span><span class="token variable"> $</span><span class="token variable punctuation">{</span><span class="token variable">last_command</span><span class="token variable punctuation">}</span><span class="token variable"> </span><span class="token variable keyword">in</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        kubectl_get </span><span class="token variable operator">|</span><span class="token variable"> kubectl_describe </span><span class="token variable operator">|</span><span class="token variable"> kubectl_delete </span><span class="token variable operator">|</span><span class="token variable"> kubectl_stop</span><span class="token variable punctuation">)</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">            __kubectl_get_resource</span></div><div class="token-line"><span class="token variable">            </span><span class="token variable builtin class-name">return</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">            </span><span class="token variable punctuation">;</span><span class="token variable punctuation">;</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">        *</span><span class="token variable punctuation">)</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">            </span><span class="token variable punctuation">;</span><span class="token variable punctuation">;</span><span class="token variable"></span></div><div class="token-line"><span class="token variable">    </span><span class="token variable keyword">esac</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable punctuation">}</span><span class="token variable"></span></div><div class="token-line"><span class="token variable"></span><span class="token variable">`</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>And then I set that in my command definition:</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">cmds </span><span class="token operator">:=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">Command</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Use</span><span class="token punctuation">:</span><span class="token plain">   </span><span class="token string">&quot;kubectl&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Short</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&quot;kubectl controls the Kubernetes cluster manager&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Long</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">`kubectl controls the Kubernetes cluster manager.</span></div><div class="token-line"><span class="token string"></span></div><div class="token-line"><span class="token string">Find more information at https://github.com/GoogleCloudPlatform/kubernetes.`</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	Run</span><span class="token punctuation">:</span><span class="token plain"> runHelp</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	BashCompletionFunction</span><span class="token punctuation">:</span><span class="token plain"> bash_completion_func</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>The <code>BashCompletionFunction</code> option is really only valid/useful on the root command. Doing the above will cause <code>__kubectl_custom_func()</code> (<code>__&lt;command-use&gt;_custom_func()</code>) to be called when the built in processor was unable to find a solution. In the case of kubernetes a valid command might look something like <code>kubectl get pod [mypod]</code>. If you type <code>kubectl get pod [tab][tab]</code> the <code>__kubectl_customc_func()</code> will run because the cobra.Command only understood &quot;kubectl&quot; and &quot;get.&quot; <code>__kubectl_custom_func()</code> will see that the cobra.Command is &quot;kubectl_get&quot; and will thus call another helper <code>__kubectl_get_resource()</code>. <code>__kubectl_get_resource</code> will look at the &#x27;nouns&#x27; collected. In our example the only noun will be <code>pod</code>. So it will call <code>__kubectl_parse_get pod</code>. <code>__kubectl_parse_get</code> will actually call out to kubernetes and get any pods. It will then set <code>COMPREPLY</code> to valid pods!</p><p>Similarly, for flags:</p><div class="__dumi-default-code-block"><pre class="prism-code language-go"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">	annotation </span><span class="token operator">:=</span><span class="token plain"> </span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	annotation</span><span class="token punctuation">[</span><span class="token plain">cobra</span><span class="token punctuation">.</span><span class="token plain">BashCompCustom</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;__kubectl_get_namespaces&quot;</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">	flag </span><span class="token operator">:=</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">pflag</span><span class="token punctuation">.</span><span class="token plain">Flag</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Name</span><span class="token punctuation">:</span><span class="token plain">        </span><span class="token string">&quot;namespace&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Usage</span><span class="token punctuation">:</span><span class="token plain">       usage</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">		Annotations</span><span class="token punctuation">:</span><span class="token plain"> annotation</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">	cmd</span><span class="token punctuation">.</span><span class="token function">Flags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AddFlag</span><span class="token punctuation">(</span><span class="token plain">flag</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>In addition add the <code>__kubectl_get_namespaces</code> implementation in the <code>BashCompletionFunction</code>value, e.g.:</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function-name function">__kubectl_get_namespaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> template</span></div><div class="token-line"><span class="token plain">    </span><span class="token assign-left variable">template</span><span class="token operator">=</span><span class="token string">&quot;{{ range .items  }}{{ .metadata.name }} {{ end }}&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> kubectl_out</span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token assign-left variable">kubectl_out</span><span class="token operator">=</span><span class="token variable">$(</span><span class="token variable">kubectl get -o template --template</span><span class="token variable operator">=</span><span class="token variable string">&quot;</span><span class="token variable string variable">${template}</span><span class="token variable string">&quot;</span><span class="token variable"> namespace </span><span class="token variable operator file-descriptor important">2</span><span class="token variable operator">&gt;</span><span class="token variable">/dev/null</span><span class="token variable">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token keyword">then</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token assign-left variable">COMPREPLY</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token plain"> </span><span class="token variable">$(</span><span class="token variable"> compgen -W </span><span class="token variable string">&quot;</span><span class="token variable string variable">${kubectl_out}</span><span class="token variable string">[*]&quot;</span><span class="token variable"> -- </span><span class="token variable string">&quot;</span><span class="token variable string variable">$cur</span><span class="token variable string">&quot;</span><span class="token variable"> </span><span class="token variable">)</span><span class="token plain"> </span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">fi</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/youngjuning/youngjuning.github.io/edit/main/docs/cobra/bash_completions.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2/20/2021 05:39:01</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.37bb31df.js"></script>
  </body>
</html>
